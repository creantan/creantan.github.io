<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>creantan</title>
  <subtitle>xiaoputaobaba</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.moesoft.com/"/>
  <updated>2017-09-05T07:16:48.000Z</updated>
  <id>http://www.moesoft.com/</id>
  
  <author>
    <name>creantan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2015第2届移动安全挑战赛iOS第一题分析</title>
    <link href="http://www.moesoft.com/2017/09/05/2015%E7%AC%AC2%E5%B1%8A%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9BiOS%E7%AC%AC%E4%B8%80%E9%A2%98%E5%88%86%E6%9E%90/"/>
    <id>http://www.moesoft.com/2017/09/05/2015第2届移动安全挑战赛iOS第一题分析/</id>
    <published>2017-09-05T07:15:37.000Z</published>
    <updated>2017-09-05T07:16:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>设备iphone6plus 拖到hopper分析，看了下label列表，看到敏感方法  <code>onClick</code>，静态分析如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div></pre></td><td class="code"><pre><div class="line"> -[ViewController onClick]:</div><div class="line">0000b6a0         push       &#123;r4, r5, r6, r7, lr&#125;                                ; Objective C Implementation defined at 0x1cd38 (instance)</div><div class="line">0000b6a2         add        r7, sp, #0xc</div><div class="line">0000b6a4         push.w     &#123;r8, r10, r11&#125;</div><div class="line">0000b6a8         sub        sp, #0x20</div><div class="line">0000b6aa         str        r0, [sp, #0x10]</div><div class="line">0000b6ac         movw       r0, #0x355c</div><div class="line">0000b6b0         movt       r0, #0x1</div><div class="line">0000b6b4         movw       r1, #0x354e</div><div class="line">0000b6b8         movt       r1, #0x1</div><div class="line">0000b6bc         movw       r2, #0x3528</div><div class="line">0000b6c0         movt       r2, #0x1</div><div class="line">0000b6c4         movw       r3, #0x3534</div><div class="line">0000b6c8         add        r0, pc                                              ; @selector(decrypt:password:)</div><div class="line">0000b6ca         movt       r3, #0x1</div><div class="line">0000b6ce         movw       r5, #0x352c</div><div class="line">0000b6d2         add        r1, pc                                              ; @selector(originalMessage)</div><div class="line">0000b6d4         movt       r5, #0x1</div><div class="line">0000b6d8         movw       r6, #0x10e4</div><div class="line">0000b6dc         ldr        r0, [r0]                                            ; @selector(decrypt:password:)</div><div class="line">0000b6de         movt       r6, #0x1</div><div class="line">0000b6e2         str        r0, [sp, #0x1c]</div><div class="line">0000b6e4         add        r3, pc                                              ; @selector(setCodedMessage:)</div><div class="line">0000b6e6         ldr        r0, [r1]                                            ; @selector(originalMessage)</div><div class="line">0000b6e8         add        r5, pc                                              ; @selector(initWithCipherKey:)</div><div class="line">0000b6ea         str        r0, [sp, #0x18]</div><div class="line">0000b6ec         movw       r0, #0x343a</div><div class="line">0000b6f0         movt       r0, #0x1</div><div class="line">0000b6f4         add        r2, pc                                              ; @selector(decrypt)</div><div class="line">0000b6f6         add        r0, pc                                              ; @selector(alloc)</div><div class="line">0000b6f8         ldr.w      r8, [r3]                                            ; @selector(setCodedMessage:)</div><div class="line">0000b6fc         ldr.w      r10, [r5]                                           ; @selector(initWithCipherKey:)</div><div class="line">0000b700         add        r6, pc                                              ; @&quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&quot;</div><div class="line">0000b702         ldr        r4, [r0]                                            ; @selector(alloc)</div><div class="line">0000b704         mov.w      r11, #0x5</div><div class="line">0000b708         ldr        r1, [r2]                                            ; @selector(decrypt)</div><div class="line">0000b70a         str        r1, [sp, #0x14]</div><div class="line"></div><div class="line">0000b70c         movw       r0, #0x38c2                                         ; XREF=-[ViewController onClick]+200</div><div class="line">0000b710         mov        r1, r4                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b712         movt       r0, #0x1</div><div class="line">0000b716         add        r0, pc                                              ; objc_cls_ref_Ceasar_CipherModel</div><div class="line">0000b718         ldr        r0, [r0]                                            ; objc_cls_ref_Ceasar_CipherModel, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b71a         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b71e         sub.w      r11, r11, #0x1   ------&gt;设置ceasar_cipher model 的cipherKey，循环5次解密4，3，2，1,0</div><div class="line">0000b722         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b724         mov        r2, r11</div><div class="line">0000b726         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b72a         mov        r5, r0       </div><div class="line">0000b72c         mov        r1, r8    ------------&gt;设置setCodedMessage           ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b72e         mov        r2, r6</div><div class="line">0000b730         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b734         ldr        r1, [sp, #0x14]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b736         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b738         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b73c         ldr        r1, [sp, #0x18]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b73e         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b740         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b744         mov        r2, r0  ----&gt;凯撒解密后的字符串用作aes解密</div><div class="line">0000b746         movw       r0, #0x388c</div><div class="line">0000b74a         movt       r0, #0x1</div><div class="line">0000b74e         ldr        r1, [sp, #0x1c]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b750         add        r0, pc                                              ; objc_cls_ref_AESCrypt</div><div class="line">0000b752         ldr        r0, [r0]                                            ; objc_cls_ref_AESCrypt, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b754         movw       r3, #0x1098</div><div class="line">0000b758         movt       r3, #0x1</div><div class="line">0000b75c         add        r3, pc            ---&gt;aes解密秘钥                     ; @&quot;ZGlhb2RhX2ppYW5rYW5nCg==&quot;</div><div class="line">0000b75e         blx        imp___symbolstub1__objc_msgSend  ----&gt;对凯撒解密后的数据进行aes解密</div><div class="line">0000b762         mov        r6, r0</div><div class="line">0000b764         cmp.w      r11, #0x0   ------&gt;循环  5次</div><div class="line">0000b768         bgt        0xb70c</div><div class="line"></div><div class="line">0000b76a         movw       r0, #0x346c</div><div class="line">0000b76e         mov        r10, r4</div><div class="line">0000b770         movt       r0, #0x1</div><div class="line">0000b774         ldr.w      r8, [sp, #0x10]</div><div class="line">0000b778         add        r0, pc                                              ; @selector(textFeild)</div><div class="line">0000b77a         ldr        r1, [r0]                                            ; @selector(textFeild), argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b77c         mov        r0, r8                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b77e         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b782         movw       r1, #0x349e</div><div class="line">0000b786         movt       r1, #0x1</div><div class="line">0000b78a         add        r1, pc                                              ; @selector(text)</div><div class="line">0000b78c         ldr        r1, [r1]                                            ; @selector(text), argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b78e         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b792         movw       r1, #0x3492</div><div class="line">0000b796         movt       r1, #0x1</div><div class="line">0000b79a         add        r1, pc                                              ; @selector(UTF8String)</div><div class="line">0000b79c         ldr        r5, [r1]                                            ; @selector(UTF8String)</div><div class="line">0000b79e         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a0         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a4         mov        r4, r0</div><div class="line">0000b7a6         mov        r0, r6                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a8         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7aa         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7ae         mov        r5, r0</div><div class="line">0000b7b0         ldrb       r0, [r5]                                            ; &quot;UTF8String&quot;</div><div class="line">0000b7b2         cmp        r0, #0x0</div><div class="line">0000b7b4         beq        0xb7d6</div><div class="line"></div><div class="line">0000b7b6         ldrb       r1, [r4]</div><div class="line">0000b7b8         cmp        r1, r0</div><div class="line">0000b7ba         bne        0xb7d2</div><div class="line"></div><div class="line">0000b7bc         movs       r6, #0x1</div><div class="line"></div><div class="line">0000b7be         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__strlen, XREF=-[ViewController onClick]+304</div><div class="line">0000b7c0         blx        imp___symbolstub1__strlen</div><div class="line">0000b7c4         cmp        r6, r0</div><div class="line">0000b7c6         bhs        0xb7d6</div><div class="line"></div><div class="line">0000b7c8         ldrb       r0, [r5, r6]</div><div class="line">0000b7ca         ldrb       r1, [r4, r6]</div><div class="line">0000b7cc         adds       r6, #0x1</div><div class="line">0000b7ce         cmp        r1, r0</div><div class="line">0000b7d0         beq        0xb7be</div><div class="line"></div><div class="line">0000b7d2         movs       r4, #0x0                                            ; XREF=-[ViewController onClick]+282</div><div class="line">0000b7d4         b          0xb7d8</div><div class="line"></div><div class="line">0000b7d6         movs       r4, #0x1                                            ; XREF=-[ViewController onClick]+276, -[ViewController onClick]+294</div><div class="line"></div><div class="line">0000b7d8         movw       r0, #0x37fe                                         ; XREF=-[ViewController onClick]+308</div><div class="line">0000b7dc         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7de         movt       r0, #0x1</div><div class="line">0000b7e2         add        r0, pc                                              ; objc_cls_ref_UIAlertView</div><div class="line">0000b7e4         ldr        r0, [r0]                                            ; objc_cls_ref_UIAlertView, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7e6         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7ea         movw       r1, #0x3438</div><div class="line">0000b7ee         cmp        r4, #0x1</div><div class="line">0000b7f0         movt       r1, #0x1</div><div class="line">0000b7f4         movw       r6, #0x1022</div><div class="line">0000b7f8         add        r1, pc                                              ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)</div><div class="line">0000b7fa         movt       r6, #0x1</div><div class="line">0000b7fe         movw       r2, #0xffa</div><div class="line">0000b802         add        r6, pc                                              ; cfstring__S_m</div><div class="line">0000b804         movt       r2, #0x1</div><div class="line">0000b808         ldr        r1, [r1]                                            ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)</div><div class="line">0000b80a         add        r2, pc                                              ; @&quot;&quot;</div><div class="line">0000b80c         bne        0xb81a</div><div class="line"></div><div class="line">0000b80e         movw       r3, #0xffe</div><div class="line">0000b812         movt       r3, #0x1</div><div class="line">0000b816         add        r3, pc                                              ; cfstring____xcknx___b_R__eQ__</div><div class="line">0000b818         b          0xb824</div><div class="line"></div><div class="line">0000b81a         movw       r3, #0x1022                                         ; XREF=-[ViewController onClick]+364</div><div class="line">0000b81e         movt       r3, #0x1</div><div class="line">0000b822         add        r3, pc                                              ; cfstring____x______</div><div class="line"></div><div class="line">0000b824         movw       r5, #0x1002                                         ; XREF=-[ViewController onClick]+376</div><div class="line">0000b828         movs       r4, #0x0</div><div class="line">0000b82a         movt       r5, #0x1</div><div class="line">0000b82e         str.w      r8, [sp]</div><div class="line">0000b832         add        r5, pc                                              ; cfstring_nx__</div><div class="line">0000b834         str        r6, [sp, #0x4]</div><div class="line">0000b836         str        r5, [sp, #0x8]</div><div class="line">0000b838         str        r4, [sp, #0xc]</div><div class="line">0000b83a         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b83e         movw       r1, #0x33ee</div><div class="line">0000b842         movt       r1, #0x1</div><div class="line">0000b846         add        r1, pc                                              ; @selector(show)</div><div class="line">0000b848         ldr        r1, [r1]                                            ; @selector(show)</div><div class="line">0000b84a         add        sp, #0x20</div><div class="line">0000b84c         pop.w      &#123;r8, r10, r11&#125;</div><div class="line">0000b850         pop.w      &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">0000b854         b.w        0x179c0</div><div class="line">                        ; endp</div></pre></td></tr></table></figure>
<p>用到加密方式：<code>凯撒加密</code>、<code>AES</code></p>
<p>还原代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">NSString* data = @&quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&quot;;</div><div class="line">NSString* password = @&quot;ZGlhb2RhX2ppYW5rYW5nCg==&quot;;</div><div class="line">int times = 5;</div><div class="line">do&#123;</div><div class="line">    times--;</div><div class="line">    Ceasar_CipherModel* model = [[Ceasar_CipherModel alloc] init];</div><div class="line">    model.cipherKey = times;</div><div class="line">    model.codedMessage = data;</div><div class="line">    [model decrypt];</div><div class="line">    data = [AESCrypt decrypt:model.originalMessage password:password];</div><div class="line">&#125;while (times &gt; 0);</div><div class="line">NSLog(@&quot;result : %@&quot;,data);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">第一次： hDmx1/d5KNhr1BBYQlRNVsZSEaOdw4MtKTpT3082x/x9lZucw0qEm+UhMaOVuoSLyqD1x0elXGXqM4nFSP3W8khfyg1ynDEwLhLt12m68U8=</div><div class="line">第二次： e1s6fwEoaC3l/4VLi1DA4KKPJdGcGWK3elMxPqOuG7MNa9fcfWu6gpui+m3q1akL</div><div class="line">第三次： 4p2eb81lORtnnduYgcAc3pxfqGh8Fybny9NFnTzYJ6B=</div><div class="line">第四次： QNEcNAUUYKq5mMZJTh3J5w==</div><div class="line">第五次： Sp4rkDr0idKit</div></pre></td></tr></table></figure>
<p>最终结果为：</p>
<blockquote>
<p>Sp4rkDr0idKit</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;设备iphone6plus 拖到hopper分析，看了下label列表，看到敏感方法  &lt;code&gt;onClick&lt;/code&gt;，静态分析如下:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;81&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;82&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;83&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;84&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;85&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;86&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;87&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;88&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;89&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;90&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;91&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;92&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;93&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;94&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;95&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;96&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;97&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;98&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;99&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;100&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;101&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;102&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;103&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;104&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;105&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;106&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;107&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;108&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;109&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;110&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;111&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;112&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;113&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;114&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;115&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;116&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;117&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;118&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;119&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;120&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;121&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;122&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;123&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;124&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;125&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;126&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;127&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;128&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;129&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;130&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;131&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;132&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;133&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;134&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;135&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;136&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;137&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;138&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;139&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;140&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;141&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;142&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;143&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;144&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;145&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;146&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;147&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;148&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;149&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;150&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;151&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;152&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;153&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;154&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;155&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;156&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;157&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;158&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;159&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;160&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;161&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;162&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;163&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;164&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;165&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;166&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;167&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;168&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt; -[ViewController onClick]:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6a0         push       &amp;#123;r4, r5, r6, r7, lr&amp;#125;                                ; Objective C Implementation defined at 0x1cd38 (instance)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6a2         add        r7, sp, #0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6a4         push.w     &amp;#123;r8, r10, r11&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6a8         sub        sp, #0x20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6aa         str        r0, [sp, #0x10]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6ac         movw       r0, #0x355c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6b0         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6b4         movw       r1, #0x354e&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6b8         movt       r1, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6bc         movw       r2, #0x3528&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6c0         movt       r2, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6c4         movw       r3, #0x3534&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6c8         add        r0, pc                                              ; @selector(decrypt:password:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6ca         movt       r3, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6ce         movw       r5, #0x352c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6d2         add        r1, pc                                              ; @selector(originalMessage)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6d4         movt       r5, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6d8         movw       r6, #0x10e4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6dc         ldr        r0, [r0]                                            ; @selector(decrypt:password:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6de         movt       r6, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6e2         str        r0, [sp, #0x1c]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6e4         add        r3, pc                                              ; @selector(setCodedMessage:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6e6         ldr        r0, [r1]                                            ; @selector(originalMessage)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6e8         add        r5, pc                                              ; @selector(initWithCipherKey:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6ea         str        r0, [sp, #0x18]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6ec         movw       r0, #0x343a&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6f0         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6f4         add        r2, pc                                              ; @selector(decrypt)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6f6         add        r0, pc                                              ; @selector(alloc)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6f8         ldr.w      r8, [r3]                                            ; @selector(setCodedMessage:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b6fc         ldr.w      r10, [r5]                                           ; @selector(initWithCipherKey:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b700         add        r6, pc                                              ; @&amp;quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b702         ldr        r4, [r0]                                            ; @selector(alloc)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b704         mov.w      r11, #0x5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b708         ldr        r1, [r2]                                            ; @selector(decrypt)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b70a         str        r1, [sp, #0x14]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b70c         movw       r0, #0x38c2                                         ; XREF=-[ViewController onClick]+200&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b710         mov        r1, r4                                              ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b712         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b716         add        r0, pc                                              ; objc_cls_ref_Ceasar_CipherModel&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b718         ldr        r0, [r0]                                            ; objc_cls_ref_Ceasar_CipherModel, argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b71a         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b71e         sub.w      r11, r11, #0x1   ------&amp;gt;设置ceasar_cipher model 的cipherKey，循环5次解密4，3，2，1,0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b722         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b724         mov        r2, r11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b726         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b72a         mov        r5, r0       &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b72c         mov        r1, r8    ------------&amp;gt;设置setCodedMessage           ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b72e         mov        r2, r6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b730         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b734         ldr        r1, [sp, #0x14]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b736         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b738         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b73c         ldr        r1, [sp, #0x18]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b73e         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b740         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b744         mov        r2, r0  ----&amp;gt;凯撒解密后的字符串用作aes解密&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b746         movw       r0, #0x388c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b74a         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b74e         ldr        r1, [sp, #0x1c]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b750         add        r0, pc                                              ; objc_cls_ref_AESCrypt&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b752         ldr        r0, [r0]                                            ; objc_cls_ref_AESCrypt, argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b754         movw       r3, #0x1098&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b758         movt       r3, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b75c         add        r3, pc            ---&amp;gt;aes解密秘钥                     ; @&amp;quot;ZGlhb2RhX2ppYW5rYW5nCg==&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b75e         blx        imp___symbolstub1__objc_msgSend  ----&amp;gt;对凯撒解密后的数据进行aes解密&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b762         mov        r6, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b764         cmp.w      r11, #0x0   ------&amp;gt;循环  5次&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b768         bgt        0xb70c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b76a         movw       r0, #0x346c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b76e         mov        r10, r4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b770         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b774         ldr.w      r8, [sp, #0x10]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b778         add        r0, pc                                              ; @selector(textFeild)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b77a         ldr        r1, [r0]                                            ; @selector(textFeild), argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b77c         mov        r0, r8                                              ; argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b77e         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b782         movw       r1, #0x349e&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b786         movt       r1, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b78a         add        r1, pc                                              ; @selector(text)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b78c         ldr        r1, [r1]                                            ; @selector(text), argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b78e         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b792         movw       r1, #0x3492&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b796         movt       r1, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b79a         add        r1, pc                                              ; @selector(UTF8String)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b79c         ldr        r5, [r1]                                            ; @selector(UTF8String)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b79e         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7a0         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7a4         mov        r4, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7a6         mov        r0, r6                                              ; argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7a8         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7aa         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ae         mov        r5, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7b0         ldrb       r0, [r5]                                            ; &amp;quot;UTF8String&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7b2         cmp        r0, #0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7b4         beq        0xb7d6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7b6         ldrb       r1, [r4]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7b8         cmp        r1, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ba         bne        0xb7d2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7bc         movs       r6, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7be         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__strlen, XREF=-[ViewController onClick]+304&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7c0         blx        imp___symbolstub1__strlen&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7c4         cmp        r6, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7c6         bhs        0xb7d6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7c8         ldrb       r0, [r5, r6]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ca         ldrb       r1, [r4, r6]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7cc         adds       r6, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ce         cmp        r1, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7d0         beq        0xb7be&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7d2         movs       r4, #0x0                                            ; XREF=-[ViewController onClick]+282&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7d4         b          0xb7d8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7d6         movs       r4, #0x1                                            ; XREF=-[ViewController onClick]+276, -[ViewController onClick]+294&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7d8         movw       r0, #0x37fe                                         ; XREF=-[ViewController onClick]+308&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7dc         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7de         movt       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7e2         add        r0, pc                                              ; objc_cls_ref_UIAlertView&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7e4         ldr        r0, [r0]                                            ; objc_cls_ref_UIAlertView, argument #1 for method imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7e6         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ea         movw       r1, #0x3438&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7ee         cmp        r4, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7f0         movt       r1, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7f4         movw       r6, #0x1022&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7f8         add        r1, pc                                              ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7fa         movt       r6, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b7fe         movw       r2, #0xffa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b802         add        r6, pc                                              ; cfstring__S_m&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b804         movt       r2, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b808         ldr        r1, [r1]                                            ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b80a         add        r2, pc                                              ; @&amp;quot;&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b80c         bne        0xb81a&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b80e         movw       r3, #0xffe&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b812         movt       r3, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b816         add        r3, pc                                              ; cfstring____xcknx___b_R__eQ__&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b818         b          0xb824&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b81a         movw       r3, #0x1022                                         ; XREF=-[ViewController onClick]+364&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b81e         movt       r3, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b822         add        r3, pc                                              ; cfstring____x______&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b824         movw       r5, #0x1002                                         ; XREF=-[ViewController onClick]+376&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b828         movs       r4, #0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b82a         movt       r5, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b82e         str.w      r8, [sp]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b832         add        r5, pc                                              ; cfstring_nx__&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b834         str        r6, [sp, #0x4]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b836         str        r5, [sp, #0x8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b838         str        r4, [sp, #0xc]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b83a         blx        imp___symbolstub1__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b83e         movw       r1, #0x33ee&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b842         movt       r1, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b846         add        r1, pc                                              ; @selector(show)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b848         ldr        r1, [r1]                                            ; @selector(show)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b84a         add        sp, #0x20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b84c         pop.w      &amp;#123;r8, r10, r11&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b850         pop.w      &amp;#123;r4, r5, r6, r7, lr&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0000b854         b.w        0x179c0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                        ; endp&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;用到加密方式：&lt;code&gt;凯撒加密&lt;/code&gt;、&lt;code&gt;AES&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;还原代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;NSString* data = @&amp;quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&amp;quot;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;NSString* password = @&amp;quot;ZGlhb2RhX2ppYW5rYW5nCg==&amp;quot;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;int times = 5;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;do&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    times--;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    Ceasar_CipherModel* model = [[Ceasar_CipherModel alloc] init];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    model.cipherKey = times;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    model.codedMessage = data;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    [model decrypt];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    data = [AESCrypt decrypt:model.originalMessage password:password];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;while (times &amp;gt; 0);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;NSLog(@&amp;quot;result : %@&amp;quot;,data);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;第一次： hDmx1/d5KNhr1BBYQlRNVsZSEaOdw4MtKTpT3082x/x9lZucw0qEm+UhMaOVuoSLyqD1x0elXGXqM4nFSP3W8khfyg1ynDEwLhLt12m68U8=&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;第二次： e1s6fwEoaC3l/4VLi1DA4KKPJdGcGWK3elMxPqOuG7MNa9fcfWu6gpui+m3q1akL&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;第三次： 4p2eb81lORtnnduYgcAc3pxfqGh8Fybny9NFnTzYJ6B=&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;第四次： QNEcNAUUYKq5mMZJTh3J5w==&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;第五次： Sp4rkDr0idKit&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最终结果为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Sp4rkDr0idKit&lt;/p&gt;
&lt;/blockquote&gt;

    
    </summary>
    
      <category term="BLOG" scheme="http://www.moesoft.com/categories/BLOG/"/>
    
    
      <category term="hopper" scheme="http://www.moesoft.com/tags/hopper/"/>
    
      <category term="ios" scheme="http://www.moesoft.com/tags/ios/"/>
    
  </entry>
  
  <entry>
    <title>2015第2届移动安全挑战赛iOS第二题分析</title>
    <link href="http://www.moesoft.com/2017/09/05/2015%E7%AC%AC2%E5%B1%8A%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9BiOS%E7%AC%AC%E4%BA%8C%E9%A2%98%E5%88%86%E6%9E%90/"/>
    <id>http://www.moesoft.com/2017/09/05/2015第2届移动安全挑战赛iOS第二题分析/</id>
    <published>2017-09-05T07:10:28.000Z</published>
    <updated>2017-09-05T07:14:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>第二题题目如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">环境：iPhone5C(A1529) iOS 8.4 kernelcache ，解密后的kernelcache见附件</div><div class="line"></div><div class="line">求得下列地址（减去kaslr）：</div><div class="line">(1)设备/dev/random，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line">(2)设备/dev/pf，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line">(3)设备/dev/ptmx，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line"></div><div class="line">假设上述地址的结果是：</div><div class="line">/dev/random</div><div class="line">d_read:0x80001231</div><div class="line">d_write:0x80001253</div><div class="line">d_ioctl:0x80001275</div><div class="line">/dev/pf</div><div class="line">d_read:0x80201297</div><div class="line">d_write:0x802012b9</div><div class="line">d_ioctl:0x801012db</div><div class="line">/dev/ptmx</div><div class="line">d_read:0x802012ed</div><div class="line">d_write:0x802012ff</div><div class="line">d_ioctl:0x80201211</div><div class="line"></div><div class="line">那么答案的格式应该是：(用#号分隔)</div><div class="line">0x80001231#0x80001253#0x80001275#0x80201297#0x802012b9#0x801012db#0x802012ed#0x802012ff#0x80201211</div></pre></td></tr></table></figure>
<p>我们知道iOS内核是基于XNU内核改的，XNU for mac的代码可以从苹果官方下载到：</p>
<ul>
<li>xnu-2782.40.9/bsd/dev/random/randomdev.c</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw random_cdevsw =</div><div class="line">&#123;</div><div class="line">	random_open,		/* open */</div><div class="line">	random_close,		/* close */</div><div class="line">	random_read,		/* read */</div><div class="line">	random_write,		/* write */</div><div class="line">	random_ioctl,		/* ioctl */</div><div class="line">	(stop_fcn_t *)nulldev, /* stop */</div><div class="line">	(reset_fcn_t *)nulldev, /* reset */</div><div class="line">	NULL,				/* tty&apos;s */</div><div class="line">	eno_select,			/* select */</div><div class="line">	eno_mmap,			/* mmap */</div><div class="line">	eno_strat,			/* strategy */</div><div class="line">	eno_getc,			/* getc */</div><div class="line">	eno_putc,			/* putc */</div><div class="line">	0					/* type */</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">/*</div><div class="line"> * Called to initialize our device,</div><div class="line"> * and to register ourselves with devfs</div><div class="line"> */</div><div class="line">void</div><div class="line">random_init(void)</div><div class="line">&#123;</div><div class="line">	int ret;</div><div class="line"></div><div class="line">	ret = cdevsw_add(RANDOM_MAJOR, &amp;random_cdevsw);</div><div class="line">	if (ret &lt; 0) &#123;</div><div class="line">		panic(&quot;random_init: failed to allocate a major number!&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	devfs_make_node(makedev (ret, RANDOM_MINOR), DEVFS_CHAR,</div><div class="line">		UID_ROOT, GID_WHEEL, 0666, &quot;random&quot;, 0);</div><div class="line"></div><div class="line">	/*</div><div class="line">	 * also make urandom </div><div class="line">	 * (which is exactly the same thing in our context)</div><div class="line">	 */</div><div class="line">	devfs_make_node(makedev (ret, URANDOM_MINOR), DEVFS_CHAR,</div><div class="line">		UID_ROOT, GID_WHEEL, 0666, &quot;urandom&quot;, 0);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>将<code>kernercache</code>拖到IDA或者hopper中分析，找到该代码段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">================ B E G I N N I N G   O F   P R O C E D U R E ================</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">             sub_800c0d88:</div><div class="line">800c0d88         push       &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">800c0d8a         add        r7, sp, #0xc</div><div class="line">800c0d8c         sub        sp, #0xc</div><div class="line">800c0d8e         movw       r0, #0xc5c6</div><div class="line">800c0d92         movt       r0, #0x2f</div><div class="line">800c0d96         add        r0, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">800c0d98         addw       r1, r0, #0xb14</div><div class="line">800c0d9c         mov.w      r0, #0xffffffff</div><div class="line">800c0da0         bl         _cdevsw_add</div><div class="line">800c0da4         mov        r4, r0</div><div class="line">800c0da6         cmp.w      r4, #0xffffffff</div><div class="line">800c0daa         bgt        0x800c0dba</div><div class="line"></div><div class="line">800c0dac         movw       r0, #0x655f</div><div class="line">800c0db0         movt       r0, #0x2b</div><div class="line">800c0db4         add        r0, pc                                              ; &quot;\\\\\\\\\\\\\\\\\\\\\\\\&quot;random_init: failed to allocate a major number!\\\\\\\\\\\\\\\\\\\\\\\\&quot;&quot;, argument #1 for method _panic</div><div class="line">800c0db6         bl         _panic</div><div class="line"></div><div class="line">800c0dba         movw       r0, #0x657b                                         ; XREF=sub_800c0d88+34</div><div class="line">800c0dbe         mov.w      r6, #0x1b6</div><div class="line">800c0dc2         movt       r0, #0x2b</div><div class="line">800c0dc6         movs       r5, #0x0</div><div class="line">800c0dc8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node</div><div class="line">800c0dca         add        r0, pc                                              ; &quot;random&quot;</div><div class="line">800c0dcc         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node</div><div class="line">800c0dce         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node</div><div class="line">800c0dd0         lsl.w      r0, r4, #0x18                                       ; argument #1 for method _devfs_make_node</div><div class="line">800c0dd4         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node</div><div class="line">800c0dd6         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node</div><div class="line">800c0dd8         str        r5, [sp, #0x8]</div><div class="line">800c0dda         bl         _devfs_make_node</div><div class="line">800c0dde         movw       r0, #0x6560</div><div class="line">800c0de2         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node</div><div class="line">800c0de4         movt       r0, #0x2b</div><div class="line">800c0de8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node</div><div class="line">800c0dea         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node</div><div class="line">800c0dec         add        r0, pc                                              ; &quot;urandom&quot;</div><div class="line">800c0dee         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node</div><div class="line">800c0df0         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node</div><div class="line">800c0df2         movs       r0, #0x1</div><div class="line">800c0df4         orr.w      r0, r0, r4, lsl #24                                 ; argument #1 for method _devfs_make_node</div><div class="line">800c0df8         str        r5, [sp, #0x8]</div><div class="line">800c0dfa         bl         _devfs_make_node</div><div class="line">800c0dfe         add        sp, #0xc</div><div class="line">800c0e00         pop        &#123;r4, r5, r6, r7, pc&#125;</div><div class="line">                        ; endp</div><div class="line">800c0e02         nop</div></pre></td></tr></table></figure>
<p>从源码中可以看出 <code>cdevsw_add</code> 函数第二个参数为<code>cdevsw</code>结构体地址<br>从汇编中算出<code>random_cdevsw</code>结构体地址为0x803bd360+0xb14 = 0x803BDE74<br>go到0x803BDE74  <code>random_cdevsw</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">803bde74         db  0x19 ; &apos;.&apos;</div><div class="line">803bde75         db  0x0e ; &apos;.&apos;</div><div class="line">803bde76         db  0x0c ; &apos;.&apos;</div><div class="line">803bde77         db  0x80 ; &apos;.&apos;</div><div class="line">803bde78         db  0x35 ; &apos;5&apos;</div><div class="line">803bde79         db  0x0e ; &apos;.&apos;</div><div class="line">803bde7a         db  0x0c ; &apos;.&apos;</div><div class="line">803bde7b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde7c         db  0xa1 ; &apos;.&apos;</div><div class="line">803bde7d         db  0x0e ; &apos;.&apos;</div><div class="line">803bde7e         db  0x0c ; &apos;.&apos;</div><div class="line">803bde7f         db  0x80 ; &apos;.&apos;  ----&gt;random_read 0x800c0ea1</div><div class="line">803bde80         db  0x39 ; &apos;9&apos;</div><div class="line">803bde81         db  0x0e ; &apos;.&apos;</div><div class="line">803bde82         db  0x0c ; &apos;.&apos;</div><div class="line">803bde83         db  0x80 ; &apos;.&apos;  ----&gt;random_write 0x800c0e39</div><div class="line">803bde84         db  0x05 ; &apos;.&apos;</div><div class="line">803bde85         db  0x0e ; &apos;.&apos;</div><div class="line">803bde86         db  0x0c ; &apos;.&apos;</div><div class="line">803bde87         db  0x80 ; &apos;.&apos;  ----&gt;random_ioctl 0x800c0e05</div><div class="line">803bde88         db  0xc9 ; &apos;.&apos;</div><div class="line">803bde89         db  0x73 ; &apos;s&apos;</div><div class="line">803bde8a         db  0x28 ; &apos;(&apos;</div><div class="line">803bde8b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde8c         db  0xc9 ; &apos;.&apos;</div><div class="line">803bde8d         db  0x73 ; &apos;s&apos;</div><div class="line">803bde8e         db  0x28 ; &apos;(&apos;</div><div class="line">803bde8f         db  0x80 ; &apos;.&apos;</div><div class="line">803bde90         db  0x00 ; &apos;.&apos;</div><div class="line">803bde91         db  0x00 ; &apos;.&apos;</div><div class="line">803bde92         db  0x00 ; &apos;.&apos;</div><div class="line">803bde93         db  0x00 ; &apos;.&apos;</div><div class="line">803bde94         db  0xad ; &apos;.&apos;</div><div class="line">803bde95         db  0x73 ; &apos;s&apos;</div><div class="line">803bde96         db  0x28 ; &apos;(&apos;</div><div class="line">803bde97         db  0x80 ; &apos;.&apos;</div><div class="line">803bde98         db  0xad ; &apos;.&apos;</div><div class="line">803bde99         db  0x73 ; &apos;s&apos;</div><div class="line">803bde9a         db  0x28 ; &apos;(&apos;</div><div class="line">803bde9b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde9c         db  0xb1 ; &apos;.&apos;</div><div class="line">803bde9d         db  0x73 ; &apos;s&apos;</div><div class="line">803bde9e         db  0x28 ; &apos;(&apos;</div><div class="line">803bde9f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea0         db  0xad ; &apos;.&apos;</div><div class="line">803bdea1         db  0x73 ; &apos;s&apos;</div><div class="line">803bdea2         db  0x28 ; &apos;(&apos;</div><div class="line">803bdea3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea4         db  0xad ; &apos;.&apos;</div><div class="line">803bdea5         db  0x73 ; &apos;s&apos;</div><div class="line">803bdea6         db  0x28 ; &apos;(&apos;</div><div class="line">803bdea7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea8         db  0x00 ; &apos;.&apos;</div><div class="line">803bdea9         db  0x00 ; &apos;.&apos;</div><div class="line">803bdeaa         db  0x00 ; &apos;.&apos;</div><div class="line">803bdeab         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/random 结果：  0x800c0ea1#0x800c0e39#0x800c0e05</div></pre></td></tr></table></figure>
<p>(2)设备/dev/pf，对应结构体<code>cdevsw</code>中<code>d_read</code>, <code>d_write</code>, <code>d_ioctl</code>在题目给出<code>kernelcache</code>中的地址。</p>
<ul>
<li>xnu-2782.40.9/bsd/net/pf_ioctl.c:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw pf_cdevsw = &#123;</div><div class="line">	/* open */	pfopen,</div><div class="line">	/* close */	pfclose,</div><div class="line">	/* read */	eno_rdwrt,</div><div class="line">	/* write */	eno_rdwrt,</div><div class="line">	/* ioctl */	pfioctl,</div><div class="line">	/* stop */	eno_stop,</div><div class="line">	/* reset */	eno_reset,</div><div class="line">	/* tty */	NULL,</div><div class="line">	/* select */	eno_select,</div><div class="line">	/* mmap */	eno_mmap,</div><div class="line">	/* strategy */	eno_strat,</div><div class="line">	/* getc */	eno_getc,</div><div class="line">	/* putc */	eno_putc,</div><div class="line">	/* type */	0</div><div class="line">&#125;;</div><div class="line"></div><div class="line">void</div><div class="line">pfinit(void)</div><div class="line">&#123;......</div><div class="line">	maj = cdevsw_add(PF_CDEV_MAJOR, &amp;pf_cdevsw);</div><div class="line">	if (maj == -1) &#123;</div><div class="line">		printf(&quot;%s: failed to allocate major number!\\\\\\\\n&quot;, __func__);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	(void) devfs_make_node(makedev(maj, PFDEV_PF), DEVFS_CHAR,</div><div class="line">	    UID_ROOT, GID_WHEEL, 0600, &quot;pf&quot;, 0);</div><div class="line"></div><div class="line">	(void) devfs_make_node(makedev(maj, PFDEV_PFM), DEVFS_CHAR,</div><div class="line">	    UID_ROOT, GID_WHEEL, 0600, &quot;pfm&quot;, 0);</div><div class="line">......</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对应<code>kernelcache</code>汇编代码（节选）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line">8024b51a         movw       r0, #0x1e3a</div><div class="line">8024b51e         movt       r0, #0x17</div><div class="line">8024b522         add        r0, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">8024b524         addw       r1, r0, #0xbbc</div><div class="line">8024b528         mov.w      r0, #0xffffffff</div><div class="line">8024b52c         bl         _cdevsw_add      </div><div class="line">8024b530         mov        r5, r0</div><div class="line">8024b532         cmp.w      r5, #0xffffffff</div><div class="line">8024b536         beq        0x8024b5ba</div><div class="line"></div><div class="line">8024b538         movw       r0, #0x4532</div><div class="line">8024b53c         mov.w      r4, #0x180</div><div class="line">8024b540         movt       r0, #0x13</div><div class="line">8024b544         mov.w      r11, #0x0</div><div class="line">8024b548         str        r4, [sp]</div><div class="line">8024b54a         add        r0, pc                                              ; &quot;pf&quot;</div><div class="line">8024b54c         movs       r1, #0x0</div><div class="line">8024b54e         str        r0, [sp, #0x4]</div><div class="line">8024b550         lsl.w      r0, r5, #0x18</div><div class="line">8024b554         movs       r2, #0x0</div><div class="line">8024b556         movs       r3, #0x0</div><div class="line">8024b558         str.w      r11, [sp, #0x8]</div><div class="line">8024b55c         bl         _devfs_make_node</div><div class="line">8024b560         movw       r0, #0x4555</div><div class="line">8024b564         movs       r1, #0x0</div><div class="line">8024b566         movt       r0, #0x13</div><div class="line">8024b56a         str        r4, [sp]</div><div class="line">8024b56c         movs       r2, #0x0</div><div class="line">8024b56e         add        r0, pc                                              ; &quot;pfm&quot;</div><div class="line">8024b570         movs       r3, #0x0</div><div class="line">8024b572         str        r0, [sp, #0x4]</div><div class="line">8024b574         movs       r0, #0x1</div><div class="line">8024b576         orr.w      r0, r0, r5, lsl #24</div><div class="line">8024b57a         str.w      r11, [sp, #0x8]</div><div class="line">8024b57e         bl         _devfs_make_node</div><div class="line"></div><div class="line">算出pf_cdevsw结构体地址为0x803bd360+0xbbc = 0x803BDF1C</div><div class="line">go到0x803BDF1C  pf_cdevsw：</div><div class="line">803bdf1c         db  0x65 ; &apos;e&apos;</div><div class="line">803bdf1d         db  0x2c ; &apos;,&apos;</div><div class="line">803bdf1e         db  0x15 ; &apos;.&apos;</div><div class="line">803bdf1f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf20         db  0xf5 ; &apos;.&apos;</div><div class="line">803bdf21         db  0x2b ; &apos;+&apos;</div><div class="line">803bdf22         db  0x15 ; &apos;.&apos;</div><div class="line">803bdf23         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf24         db  0xad ; &apos;.&apos;</div><div class="line">803bdf25         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf26         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf27         db  0x80 ; &apos;.&apos;  ----&gt;eno_rdwrt 0x802873ad</div><div class="line">803bdf28         db  0xad ; &apos;.&apos;</div><div class="line">803bdf29         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf2a         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf2b         db  0x80 ; &apos;.&apos;  ----&gt;eno_rdwrt 0x802873ad</div><div class="line">803bdf2c         db  0x19 ; &apos;.&apos;</div><div class="line">803bdf2d         db  0x9d ; &apos;.&apos;</div><div class="line">803bdf2e         db  0x14 ; &apos;.&apos;</div><div class="line">803bdf2f         db  0x80 ; &apos;.&apos;  ----&gt;pfioctl 0x80149d19</div><div class="line">803bdf30         db  0xad ; &apos;.&apos;</div><div class="line">803bdf31         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf32         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf33         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf34         db  0xad ; &apos;.&apos;</div><div class="line">803bdf35         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf36         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf37         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf38         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf39         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3a         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3b         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3c         db  0xad ; &apos;.&apos;</div><div class="line">803bdf3d         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf3e         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf3f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf40         db  0xad ; &apos;.&apos;</div><div class="line">803bdf41         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf42         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf43         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf44         db  0xb1 ; &apos;.&apos;</div><div class="line">803bdf45         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf46         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf47         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf48         db  0xad ; &apos;.&apos;</div><div class="line">803bdf49         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf4a         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf4b         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf4c         db  0xad ; &apos;.&apos;</div><div class="line">803bdf4d         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf4e         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf4f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf50         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf51         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf52         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf53         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/pf 的结果：  0x802873ad#0x802873ad#0x80149d19</div></pre></td></tr></table></figure>
<p>(3)设备<code>/dev/ptmx</code>，对应结构体<code>cdevsw</code>中<code>d_read</code>, <code>d_write</code>, <code>d_ioctl</code>在题目给出<code>kernelcache</code>中的地址。</p>
<ul>
<li>/xnu-2782.40.9/bsd/kern/tty_ptmx.c:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw ptmx_cdev = &#123;</div><div class="line">	ptcopen,	ptcclose,	ptcread,	ptcwrite,</div><div class="line">	ptyioctl,	ptcstop,	ptcreset,	0,</div><div class="line">	ptcselect,	eno_mmap,	eno_strat,	eno_getc,</div><div class="line">	eno_putc,	D_TTY</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int</div><div class="line">ptmx_init( __unused int config_count)</div><div class="line">&#123;</div><div class="line">	/*</div><div class="line">	 * We start looking at slot 10, since there are inits that will</div><div class="line">	 * stomp explicit slots (e.g. vndevice stomps 1) below that.</div><div class="line">	 */</div><div class="line"></div><div class="line">	/* Get a major number for /dev/ptmx */</div><div class="line">	if((ptmx_major = cdevsw_add(-15, &amp;ptmx_cdev)) == -1) &#123;</div><div class="line">		printf(&quot;ptmx_init: failed to obtain /dev/ptmx major number\\\\\\\\n&quot;);</div><div class="line">		return (ENOENT);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	if (cdevsw_setkqueueok(ptmx_major, &amp;ptmx_cdev, 0) == -1) &#123;</div><div class="line">		panic(&quot;Failed to set flags on ptmx cdevsw entry.&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/* Get a major number for /dev/pts/nnn */</div><div class="line">	if ((ptsd_major = cdevsw_add(-15, &amp;ptsd_cdev)) == -1) &#123;</div><div class="line">		(void)cdevsw_remove(ptmx_major, &amp;ptmx_cdev);</div><div class="line">		printf(&quot;ptmx_init: failed to obtain /dev/ptmx major number\\\\\\\\n&quot;);</div><div class="line">		return (ENOENT);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	if (cdevsw_setkqueueok(ptsd_major, &amp;ptsd_cdev, 0) == -1) &#123;</div><div class="line">		panic(&quot;Failed to set flags on ptmx cdevsw entry.&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/*</div><div class="line">	 * Locks to guard against races between revoke and kevents</div><div class="line">	 */</div><div class="line">	ptsd_kevent_lock_init();</div><div class="line"></div><div class="line">	/* Create the /dev/ptmx device &#123;&lt;major&gt;,0&#125; */</div><div class="line">	(void)devfs_make_node_clone(makedev(ptmx_major, 0),</div><div class="line">				DEVFS_CHAR, UID_ROOT, GID_TTY, 0666,</div><div class="line">				ptmx_clone, PTMX_TEMPLATE);</div><div class="line"></div><div class="line">	_ptmx_driver.master = ptmx_major;</div><div class="line">	_ptmx_driver.slave = ptsd_major;</div><div class="line">	_ptmx_driver.fix_7828447 = 1;</div><div class="line">	_ptmx_driver.fix_7070978 = 1;</div><div class="line">#if CONFIG_MACF</div><div class="line">	_ptmx_driver.mac_notify = 1;</div><div class="line">#endif</div><div class="line">	_ptmx_driver.open = &amp;ptmx_get_ioctl;</div><div class="line">	_ptmx_driver.free = &amp;ptmx_free_ioctl;</div><div class="line">	_ptmx_driver.name = &amp;ptmx_get_name;</div><div class="line">	_ptmx_driver.revoke = &amp;ptsd_revoke_knotes;</div><div class="line">	tty_dev_register(&amp;_ptmx_driver);</div><div class="line"></div><div class="line">	return (0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对应<code>kernelcache</code>汇编代码（节选）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">80293330         push       &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">80293332         add        r7, sp, #0xc</div><div class="line">80293334         push.w     &#123;r8, r10, r11&#125;</div><div class="line">80293338         sub        sp, #0xc</div><div class="line">8029333a         movw       r4, #0xa016</div><div class="line">8029333e         mvn        r0, #0xe</div><div class="line">80293342         movt       r4, #0x12</div><div class="line">80293346         add        r4, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">80293348         addw       r1, r4, #0xc2c</div><div class="line">8029334c         bl         _cdevsw_add</div><div class="line">80293350         movw       r8, #0x6b90</div><div class="line">80293354         cmp.w      r0, #0xffffffff</div><div class="line">80293358         movt       r8, #0x16</div><div class="line">8029335c         add        r8, pc                                              ; 0x803f9ef0</div><div class="line">8029335e         str.w      r0, [r8, #0xc58]                                    ; 0x803fab48</div><div class="line">80293362         beq        0x80293412</div><div class="line"></div><div class="line">80293364         cmp        r0, #0x2a</div><div class="line">80293366         bhi        0x802933a8</div><div class="line"></div><div class="line">80293368         movw       r1, #0xe0d0</div><div class="line">8029336c         rsb        r2, r0, r0, lsl #3</div><div class="line">80293370         movt       r1, #0x11</div><div class="line">80293374         add        r1, pc                                              ; _cdevsw</div><div class="line">80293376         add.w      r1, r1, r2, lsl #3</div><div class="line">8029337a         movs       r2, #0x0</div><div class="line"></div><div class="line">8029337c         adds       r6, r4, r2                                          ; XREF=sub_80293330+92</div><div class="line">8029337e         ldrb       r3, [r1, r2]</div><div class="line">80293380         ldrb.w     r6, [r6, #0xc2c]</div><div class="line">80293384         cmp        r3, r6</div><div class="line">80293386         bne        0x802933a8</div><div class="line"></div><div class="line">80293388         adds       r2, #0x1</div><div class="line">8029338a         cmp        r2, #0x38</div><div class="line">8029338c         bne        0x8029337c</div><div class="line"></div><div class="line">8029338e         movw       r1, #0x583c</div><div class="line">80293392         movs       r2, #0x1</div><div class="line">80293394         movt       r1, #0x16</div><div class="line">80293398         add        r1, pc                                              ; 0x803f8bd8</div><div class="line">8029339a         str.w      r2, [r1, r0, lsl #3]</div><div class="line">8029339e         add.w      r0, r1, r0, lsl #3</div><div class="line">802933a2         movs       r1, #0x0</div><div class="line">802933a4         str        r1, [r0, #0x4]</div><div class="line">802933a6         b          0x802933b6</div><div class="line"></div><div class="line">802933a8         movw       r0, #0xeb91                                         ; XREF=sub_80293330+54, sub_80293330+86</div><div class="line">802933ac         movt       r0, #0xc</div><div class="line">802933b0         add        r0, pc                                              ; &quot;\\\\\\\\\\\\\\\\\\\\\\\\&quot;Failed to set flags on ptmx cdevsw entry.\\\\\\\\\\\\\\\\\\\\\\\\&quot;&quot;, argument #1 for method _panic</div><div class="line">802933b2         bl         _panic</div><div class="line"></div><div class="line">802933b6         addw       r1, r4, #0xc64                                      ; XREF=sub_80293330+118</div><div class="line">802933ba         mvn        r0, #0xe</div><div class="line">802933be         bl         _cdevsw_add</div></pre></td></tr></table></figure>
<p>算出<code>ptmx_cdev</code>结构体地址为0x803bd360+0xc2c = 0x803BDF8C<br>go到0x803BDF8C  <code>ptmx_cdev</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">803bdf8c         db  0x9d ; &apos;.&apos;</div><div class="line">803bdf8d         db  0x1f ; &apos;.&apos;</div><div class="line">803bdf8e         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf8f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf90         db  0xd5 ; &apos;.&apos;</div><div class="line">803bdf91         db  0x20 ; &apos; &apos;</div><div class="line">803bdf92         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf93         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf94         db  0x51 ; &apos;Q&apos;</div><div class="line">803bdf95         db  0x22 ; &apos;&quot;&apos;</div><div class="line">803bdf96         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf97         db  0x80 ; &apos;.&apos; ----&gt;ptcread 0x80292251</div><div class="line">803bdf98         db  0x61 ; &apos;a&apos;</div><div class="line">803bdf99         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdf9a         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9b         db  0x80 ; &apos;.&apos; ----&gt;ptcwrite 0x80292661</div><div class="line">803bdf9c         db  0x8d ; &apos;.&apos;</div><div class="line">803bdf9d         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9e         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9f         db  0x80 ; &apos;.&apos; ----&gt;ptyioctl 0x8029298d</div><div class="line">803bdfa0         db  0x59 ; &apos;Y&apos;</div><div class="line">803bdfa1         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdfa2         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfa3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfa4         db  0x5d ; &apos;]&apos;</div><div class="line">803bdfa5         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdfa6         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfa7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfa8         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfa9         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfaa         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfab         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfac         db  0x0d ; &apos;.&apos;</div><div class="line">803bdfad         db  0x25 ; &apos;%&apos;</div><div class="line">803bdfae         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfaf         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb0         db  0xad ; &apos;.&apos;</div><div class="line">803bdfb1         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfb2         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfb3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb4         db  0xb1 ; &apos;.&apos;</div><div class="line">803bdfb5         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfb6         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfb7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb8         db  0xad ; &apos;.&apos;</div><div class="line">803bdfb9         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfba         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfbb         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfbc         db  0xad ; &apos;.&apos;</div><div class="line">803bdfbd         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfbe         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfbf         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfc0         db  0x03 ; &apos;.&apos;</div><div class="line">803bdfc1         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfc2         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfc3         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/ptmx 的结果：  0x80292251#0x80292661#0x8029298d</div></pre></td></tr></table></figure>
<p>所以最终结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0x800c0ea1#0x800c0e39#0x800c0e05#0x802873ad#0x802873ad#0x80149d19#0x80292251#0x80292661#0x8029298d</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第二题题目如下&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;环境：iPhone5C(A1529) iOS 8.4 kernelcache ，解密后的kernelcache见附件&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;求得下列地址（减去kaslr）：&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(1)设备/dev/random，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(2)设备/dev/pf，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(3)设备/dev/ptmx，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;假设上述地址的结果是：&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/dev/random&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_read:0x80001231&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_write:0x80001253&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_ioctl:0x80001275&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/dev/pf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_read:0x80201297&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_write:0x802012b9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_ioctl:0x801012db&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/dev/ptmx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_read:0x802012ed&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_write:0x802012ff&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;d_ioctl:0x80201211&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;那么答案的格式应该是：(用#号分隔)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x80001231#0x80001253#0x80001275#0x80201297#0x802012b9#0x801012db#0x802012ed#0x802012ff#0x80201211&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们知道iOS内核是基于XNU内核改的，XNU for mac的代码可以从苹果官方下载到：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;xnu-2782.40.9/bsd/dev/random/randomdev.c&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;static struct cdevsw random_cdevsw =&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	random_open,		/* open */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	random_close,		/* close */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	random_read,		/* read */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	random_write,		/* write */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	random_ioctl,		/* ioctl */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	(stop_fcn_t *)nulldev, /* stop */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	(reset_fcn_t *)nulldev, /* reset */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	NULL,				/* tty&amp;apos;s */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eno_select,			/* select */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eno_mmap,			/* mmap */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eno_strat,			/* strategy */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eno_getc,			/* getc */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eno_putc,			/* putc */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	0					/* type */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/*&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * Called to initialize our device,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * and to register ourselves with devfs&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;void&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;random_init(void)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	int ret;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	ret = cdevsw_add(RANDOM_MAJOR, &amp;amp;random_cdevsw);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	if (ret &amp;lt; 0) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		panic(&amp;quot;random_init: failed to allocate a major number!&amp;quot;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	devfs_make_node(makedev (ret, RANDOM_MINOR), DEVFS_CHAR,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		UID_ROOT, GID_WHEEL, 0666, &amp;quot;random&amp;quot;, 0);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	/*&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 * also make urandom &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 * (which is exactly the same thing in our context)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	devfs_make_node(makedev (ret, URANDOM_MINOR), DEVFS_CHAR,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		UID_ROOT, GID_WHEEL, 0666, &amp;quot;urandom&amp;quot;, 0);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将&lt;code&gt;kernercache&lt;/code&gt;拖到IDA或者hopper中分析，找到该代码段：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;================ B E G I N N I N G   O F   P R O C E D U R E ================&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;             sub_800c0d88:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d88         push       &amp;#123;r4, r5, r6, r7, lr&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d8a         add        r7, sp, #0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d8c         sub        sp, #0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d8e         movw       r0, #0xc5c6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d92         movt       r0, #0x2f&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d96         add        r0, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d98         addw       r1, r0, #0xb14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0d9c         mov.w      r0, #0xffffffff&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0da0         bl         _cdevsw_add&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0da4         mov        r4, r0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0da6         cmp.w      r4, #0xffffffff&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0daa         bgt        0x800c0dba&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dac         movw       r0, #0x655f&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0db0         movt       r0, #0x2b&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0db4         add        r0, pc                                              ; &amp;quot;\\\\\\\\\\\\\\\\\\\\\\\\&amp;quot;random_init: failed to allocate a major number!\\\\\\\\\\\\\\\\\\\\\\\\&amp;quot;&amp;quot;, argument #1 for method _panic&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0db6         bl         _panic&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dba         movw       r0, #0x657b                                         ; XREF=sub_800c0d88+34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dbe         mov.w      r6, #0x1b6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dc2         movt       r0, #0x2b&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dc6         movs       r5, #0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dc8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dca         add        r0, pc                                              ; &amp;quot;random&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dcc         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dce         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dd0         lsl.w      r0, r4, #0x18                                       ; argument #1 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dd4         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dd6         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dd8         str        r5, [sp, #0x8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dda         bl         _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dde         movw       r0, #0x6560&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0de2         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0de4         movt       r0, #0x2b&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0de8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dea         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dec         add        r0, pc                                              ; &amp;quot;urandom&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dee         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0df0         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0df2         movs       r0, #0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0df4         orr.w      r0, r0, r4, lsl #24                                 ; argument #1 for method _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0df8         str        r5, [sp, #0x8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dfa         bl         _devfs_make_node&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0dfe         add        sp, #0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0e00         pop        &amp;#123;r4, r5, r6, r7, pc&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                        ; endp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;800c0e02         nop&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从源码中可以看出 &lt;code&gt;cdevsw_add&lt;/code&gt; 函数第二个参数为&lt;code&gt;cdevsw&lt;/code&gt;结构体地址&lt;br&gt;从汇编中算出&lt;code&gt;random_cdevsw&lt;/code&gt;结构体地址为0x803bd360+0xb14 = 0x803BDE74&lt;br&gt;go到0x803BDE74  &lt;code&gt;random_cdevsw&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;803bde74         db  0x19 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde75         db  0x0e ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde76         db  0x0c ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde77         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde78         db  0x35 ; &amp;apos;5&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde79         db  0x0e ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7a         db  0x0c ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7b         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7c         db  0xa1 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7d         db  0x0e ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7e         db  0x0c ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde7f         db  0x80 ; &amp;apos;.&amp;apos;  ----&amp;gt;random_read 0x800c0ea1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde80         db  0x39 ; &amp;apos;9&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde81         db  0x0e ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde82         db  0x0c ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde83         db  0x80 ; &amp;apos;.&amp;apos;  ----&amp;gt;random_write 0x800c0e39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde84         db  0x05 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde85         db  0x0e ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde86         db  0x0c ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde87         db  0x80 ; &amp;apos;.&amp;apos;  ----&amp;gt;random_ioctl 0x800c0e05&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde88         db  0xc9 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde89         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8a         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8b         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8c         db  0xc9 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8d         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8e         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde8f         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde90         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde91         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde92         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde93         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde94         db  0xad ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde95         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde96         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde97         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde98         db  0xad ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde99         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9a         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9b         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9c         db  0xb1 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9d         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9e         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bde9f         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea0         db  0xad ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea1         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea2         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea3         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea4         db  0xad ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea5         db  0x73 ; &amp;apos;s&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea6         db  0x28 ; &amp;apos;(&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea7         db  0x80 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea8         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdea9         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdeaa         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;803bdeab         db  0x00 ; &amp;apos;.&amp;apos;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;得到 /dev/random 结果：  0x800c0ea1#0x800c0e39#0x800c0e05&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="BLOG" scheme="http://www.moesoft.com/categories/BLOG/"/>
    
    
      <category term="hopper" scheme="http://www.moesoft.com/tags/hopper/"/>
    
      <category term="ios" scheme="http://www.moesoft.com/tags/ios/"/>
    
      <category term="kernel" scheme="http://www.moesoft.com/tags/kernel/"/>
    
  </entry>
  
  <entry>
    <title>破解TexturePacker加密资源，寻找解密Key之旅</title>
    <link href="http://www.moesoft.com/2017/09/05/%E7%A0%B4%E8%A7%A3TexturePacker%E5%8A%A0%E5%AF%86%E8%B5%84%E6%BA%90%EF%BC%8C%E5%AF%BB%E6%89%BE%E8%A7%A3%E5%AF%86Key%E4%B9%8B%E6%97%85/"/>
    <id>http://www.moesoft.com/2017/09/05/破解TexturePacker加密资源，寻找解密Key之旅/</id>
    <published>2017-09-05T07:05:27.000Z</published>
    <updated>2017-09-05T07:14:59.000Z</updated>
    
    <content type="html"><![CDATA[<p>破解TexturePacker加密资源的方式有好多种。。最多的是hook <code>uncompress</code>然后获取到内容，加入ccz的文件头写入文件。<br>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://blog.csdn.net/ynnmnm/article/details/38392795</div><div class="line">http://bbs.pediy.com/showthread.php?t=187332</div></pre></td></tr></table></figure></p>
<p>今天我用最直接的方法搞定，直接找到用户设置的秘钥。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void ZipUtils::ccSetPvrEncryptionKeyPart(int index, unsigned int value)// 设置密钥的接口</div></pre></td></tr></table></figure></p>
<p>上appstore上随便找个cocos2d的游戏，拖入Hopper，搜索<code>ccSetPvrEncryptionKeyPart</code>，没有找到。然后搜索ZipUtils，如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/416783-ed56d50b50646b28.png" alt="04E5BC6A-B738-473A-B184-82620C3C66C8.png"></p>
<p><code>ccDecodeEncodedPvr</code>用来解密pvr.ccz文件，没有找到<code>ccSetPvrEncryptionKeyPart</code>，那么我们在<code>ccDecodeEncodedPvr</code>上下代码块里面试试运气</p>
<p><img src="http://upload-images.jianshu.io/upload_images/416783-8ca904a53c640e6d.png" alt="E023B78F-3D67-4D35-8613-E610F6F36D1A.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">int sub_444200(int arg0, int arg1) &#123;</div><div class="line">    r1 = arg1;</div><div class="line">    r0 = arg0;</div><div class="line">    r3 = *(0x7d79d0 + r0 * 0x4);</div><div class="line">    asm&#123; it         eq &#125;;</div><div class="line">    if (r3 == r1) &#123;</div><div class="line">            return r0;</div><div class="line">    &#125;</div><div class="line">    *(0x7d79d0 + r0 * 0x4) = r1;</div><div class="line">    *(int8_t *)0x7d89e0 = 0x0;</div><div class="line">    return 0x0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个有点像。。猜测arg0为index  arg1为value<br>写tweak验证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">int(*orgccSetPvrEncryptionKey)(int index,unsigned int key);</div><div class="line">int myccSetPvrEncryptionKey(int index,unsigned int key);</div><div class="line">int myccSetPvrEncryptionKey(int index,unsigned int key2key&#123;</div><div class="line">  NSLog(@&quot;\n\n=====  keys: %d-%u    ======\n\n&quot;,index,key);</div><div class="line">  orgccSetPvrEncryptionKey(key1,key2);</div><div class="line">&#125;</div><div class="line">%ctor&#123;</div><div class="line">  NSLog(@&quot;====== HOOKED ======&quot;);</div><div class="line">  intptr_t module_vmaddr = _dyld_get_image_vmaddr_slide(0);</div><div class="line">  intptr_t ccSetPvrEncryptionKey = module_vmaddr + 0x444200 + 1;</div><div class="line">  MSHookFunction((void *)ccSetPvrEncryptionKey, (void*)myccSetPvrEncryptionKey, (void**)&amp;orgccSetPvrEncryptionKey);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Jun  1 11:57:43 crean XXX[73393]:</div><div class="line"></div><div class="line">	=====  keys: 0-405172683    ======</div><div class="line">Jun  1 11:57:43 crean XXX[73393]:</div><div class="line"></div><div class="line">	=====  keys: 1-1270815801    ======</div><div class="line">Jun  1 11:57:43 crean XXX[73393]:</div><div class="line"></div><div class="line">	=====  keys: 2-3663874658    ======</div><div class="line">Jun  1 11:57:43 crean XXX[73393]:</div><div class="line"></div><div class="line">	=====  keys: 3-2333226975    ======</div></pre></td></tr></table></figure>
<p>将这4个Key转为16进制为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">182671CB4BBF1C39DA624A628B1237DF</div></pre></td></tr></table></figure></p>
<p>用TexturePacker打开加密的pvr.ccz的文件，它会提示你输入128位加密的KEY，输入直接解密验证：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/416783-65e0579bdbd8e44c.png" alt="5B26E15B-9F72-4166-B1C7-6438C0076623.png"></p>
<p>我想，看了这篇教程学到的不紧紧是破解TexturePacker加密资源哦。。自己动手验证试试。。只随机了一个游戏测试。。有兴趣的朋友可以找个游戏验证验证是否通用。。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;破解TexturePacker加密资源的方式有好多种。。最多的是hook &lt;code&gt;uncompress&lt;/code&gt;然后获取到内容，加入ccz的文件头写入文件。&lt;br&gt;例如：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;http://blog.csdn.net/ynnmnm/article/details/38392795&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;http://bbs.pediy.com/showthread.php?t=187332&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;今天我用最直接的方法搞定，直接找到用户设置的秘钥。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;void ZipUtils::ccSetPvrEncryptionKeyPart(int index, unsigned int value)// 设置密钥的接口&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上appstore上随便找个cocos2d的游戏，拖入Hopper，搜索&lt;code&gt;ccSetPvrEncryptionKeyPart&lt;/code&gt;，没有找到。然后搜索ZipUtils，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/416783-ed56d50b50646b28.png&quot; alt=&quot;04E5BC6A-B738-473A-B184-82620C3C66C8.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ccDecodeEncodedPvr&lt;/code&gt;用来解密pvr.ccz文件，没有找到&lt;code&gt;ccSetPvrEncryptionKeyPart&lt;/code&gt;，那么我们在&lt;code&gt;ccDecodeEncodedPvr&lt;/code&gt;上下代码块里面试试运气&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/416783-8ca904a53c640e6d.png&quot; alt=&quot;E023B78F-3D67-4D35-8613-E610F6F36D1A.png&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;int sub_444200(int arg0, int arg1) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    r1 = arg1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    r0 = arg0;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    r3 = *(0x7d79d0 + r0 * 0x4);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    asm&amp;#123; it         eq &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    if (r3 == r1) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            return r0;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    *(0x7d79d0 + r0 * 0x4) = r1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    *(int8_t *)0x7d89e0 = 0x0;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    return 0x0;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个有点像。。猜测arg0为index  arg1为value&lt;br&gt;写tweak验证：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;int(*orgccSetPvrEncryptionKey)(int index,unsigned int key);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;int myccSetPvrEncryptionKey(int index,unsigned int key);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;int myccSetPvrEncryptionKey(int index,unsigned int key2key&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  NSLog(@&amp;quot;\n\n=====  keys: %d-%u    ======\n\n&amp;quot;,index,key);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  orgccSetPvrEncryptionKey(key1,key2);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;%ctor&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  NSLog(@&amp;quot;====== HOOKED ======&amp;quot;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  intptr_t module_vmaddr = _dyld_get_image_vmaddr_slide(0);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  intptr_t ccSetPvrEncryptionKey = module_vmaddr + 0x444200 + 1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  MSHookFunction((void *)ccSetPvrEncryptionKey, (void*)myccSetPvrEncryptionKey, (void**)&amp;amp;orgccSetPvrEncryptionKey);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试log&lt;/p&gt;
    
    </summary>
    
      <category term="BLOG" scheme="http://www.moesoft.com/categories/BLOG/"/>
    
    
      <category term="TexturePacker" scheme="http://www.moesoft.com/tags/TexturePacker/"/>
    
      <category term="macos" scheme="http://www.moesoft.com/tags/macos/"/>
    
  </entry>
  
  <entry>
    <title>IOS游戏加速原理与实现</title>
    <link href="http://www.moesoft.com/2017/09/05/IOS%E6%B8%B8%E6%88%8F%E5%8A%A0%E9%80%9F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
    <id>http://www.moesoft.com/2017/09/05/IOS游戏加速原理与实现/</id>
    <published>2017-09-05T06:33:58.000Z</published>
    <updated>2017-09-05T06:39:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>游戏助手（如XX助手）有一项游戏加速功能，实现原理其实非常简单，直接hook <code>gettimeofday</code>。</p>
<p>实现tweak代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//  speedup.xm</div><div class="line">//  create by creantan on 14-10-23</div><div class="line">static int (*orig_gettimeofday)(struct timeval * __restrict, void * __restrict);</div><div class="line">static int mygettimeofday(struct timeval*tv,struct timezone *tz ) &#123;</div><div class="line">    int ret = orig_gettimeofday(tv,tz);</div><div class="line">    if (ret == 0) &#123;</div><div class="line">        tv-&gt;tv_usec *= SPEEDLEVEL;</div><div class="line">        tv-&gt;tv_sec *= SPEEDLEVEL;</div><div class="line">    &#125;</div><div class="line">    return ret;</div><div class="line">&#125;</div><div class="line">%ctor &#123;</div><div class="line">    MSHookFunction((void *)MSFindSymbol(NULL,&quot;_gettimeofday&quot;), (void *)mygettimeofday, (void **)&amp;orig_gettimeofday);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;游戏助手（如XX助手）有一项游戏加速功能，实现原理其实非常简单，直接hook &lt;code&gt;gettimeofday&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;实现tweak代码如下：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;//  speedup.xm&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;//  create by creantan on 14-10-23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;static int (*orig_gettimeofday)(struct timeval * __restrict, void * __restrict);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;static int mygettimeofday(struct timeval*tv,struct timezone *tz ) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    int ret = orig_gettimeofday(tv,tz);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    if (ret == 0) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        tv-&amp;gt;tv_usec *= SPEEDLEVEL;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        tv-&amp;gt;tv_sec *= SPEEDLEVEL;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    return ret;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;%ctor &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    MSHookFunction((void *)MSFindSymbol(NULL,&amp;quot;_gettimeofday&amp;quot;), (void *)mygettimeofday, (void **)&amp;amp;orig_gettimeofday);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;

    
    </summary>
    
      <category term="BLOG" scheme="http://www.moesoft.com/categories/BLOG/"/>
    
    
      <category term="tweak" scheme="http://www.moesoft.com/tags/tweak/"/>
    
      <category term="游戏加速" scheme="http://www.moesoft.com/tags/%E6%B8%B8%E6%88%8F%E5%8A%A0%E9%80%9F/"/>
    
  </entry>
  
  <entry>
    <title>MAC平台下的crackme两例分析</title>
    <link href="http://www.moesoft.com/2017/09/05/MAC%E5%B9%B3%E5%8F%B0%E4%B8%8B%E7%9A%84crackme%E4%B8%A4%E4%BE%8B%E5%88%86%E6%9E%90/"/>
    <id>http://www.moesoft.com/2017/09/05/MAC平台下的crackme两例分析/</id>
    <published>2017-09-05T06:00:23.000Z</published>
    <updated>2017-09-05T06:23:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="工具列表："><a href="#工具列表：" class="headerlink" title="工具列表："></a>工具列表：</h3><ul>
<li>Hopper disassembler（静态分析）</li>
<li>lldb （动态调试）</li>
</ul>
<p>先来个最简单的，直接用Hopper disassembler分析：<br>直接把第一个crackme拖到Hopper里面，看下左边窗口，看下这个crackme的Labels</p>
<p>很容易就找到这个methed实现<code>methImpl_AppDelegate_checkifisok_</code><br>点击它看下汇编：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line">0x0000000100001110 55                              push       rbp</div><div class="line">0x0000000100001111 4889E5                          mov        rbp, rsp</div><div class="line">0x0000000100001114 4883EC70                        sub        rsp, 0x70</div><div class="line">0x0000000100001118 488D0551180000                  lea        rax, qword [ds:cfstring_Length_of_the_serial_string_is___lx] ; @&quot;Length of the serial string is: %lx&quot;</div><div class="line">0x000000010000111f 488D0DBA160000                  lea        rcx, qword [ds:objc_msg_length] ; @selector(length)</div><div class="line">0x0000000100001126 4C8D0523180000                  lea        r8, qword [ds:cfstring_Length_of_the_name_string_is___lx] ; @&quot;Length of the name string is: %lx&quot;</div><div class="line">0x000000010000112d 4C8D0DFC170000                  lea        r9, qword [ds:cfstring_uh_] ; @&quot;uh?&quot;</div><div class="line">0x0000000100001134 48897DF8                        mov        qword [ss:rbp-0x70+var_104], rdi</div><div class="line">0x0000000100001138 488975F0                        mov        qword [ss:rbp-0x70+var_96], rsi</div><div class="line">0x000000010000113c 488955E8                        mov        qword [ss:rbp-0x70+var_88], rdx</div><div class="line">0x0000000100001140 4C89CF                          mov        rdi, r9</div><div class="line">0x0000000100001143 488945B0                        mov        qword [ss:rbp-0x70+var_32], rax</div><div class="line">0x0000000100001147 B000                            mov        al, 0x0</div><div class="line">0x0000000100001149 4C8945A8                        mov        qword [ss:rbp-0x70+var_24], r8</div><div class="line">0x000000010000114d 48894DA0                        mov        qword [ss:rbp-0x70+var_16], rcx</div><div class="line">0x0000000100001151 E8C6030000                      call       imp___stubs__NSLog</div><div class="line">0x0000000100001156 488B4DF8                        mov        rcx, qword [ss:rbp-0x70+var_104]</div><div class="line">0x000000010000115a 488B152F190000                  mov        rdx, qword [ds:0x100002a90]</div><div class="line">0x0000000100001161 488B0C11                        mov        rcx, qword [ds:rcx+rdx]</div><div class="line">0x0000000100001165 488B350C160000                  mov        rsi, qword [ds:objc_sel_stringValue] ; @selector(stringValue)</div><div class="line">0x000000010000116c 4889CF                          mov        rdi, rcx</div><div class="line">0x000000010000116f E8B4030000                      call       imp___stubs__objc_msgSend</div><div class="line">0x0000000100001174 488945E0                        mov        qword [ss:rbp-0x70+var_80], rax</div><div class="line">0x0000000100001178 488B45E0                        mov        rax, qword [ss:rbp-0x70+var_80]</div><div class="line">0x000000010000117c 4889C7                          mov        rdi, rax</div><div class="line">0x000000010000117f 488B75A0                        mov        rsi, qword [ss:rbp-0x70+var_16]</div><div class="line">0x0000000100001183 FF1557160000                    call       qword [ds:objc_msg_length]  ; @selector(length)</div><div class="line">0x0000000100001189 488945D8                        mov        qword [ss:rbp-0x70+var_72], rax</div><div class="line">0x000000010000118d 488B75D8                        mov        rsi, qword [ss:rbp-0x70+var_72]</div><div class="line">0x0000000100001191 488B7DA8                        mov        rdi, qword [ss:rbp-0x70+var_24]</div><div class="line">0x0000000100001195 B000                            mov        al, 0x0</div><div class="line">0x0000000100001197 E880030000                      call       imp___stubs__NSLog</div><div class="line">0x000000010000119c 488B4DF8                        mov        rcx, qword [ss:rbp-0x70+var_104]</div><div class="line">0x00000001000011a0 488B15F1180000                  mov        rdx, qword [ds:0x100002a98]</div><div class="line">0x00000001000011a7 488B0C11                        mov        rcx, qword [ds:rcx+rdx]</div><div class="line">0x00000001000011ab 488B35C6150000                  mov        rsi, qword [ds:objc_sel_stringValue] ; @selector(stringValue)</div><div class="line">0x00000001000011b2 4889CF                          mov        rdi, rcx</div><div class="line">0x00000001000011b5 E86E030000                      call       imp___stubs__objc_msgSend</div><div class="line">0x00000001000011ba 488945D0                        mov        qword [ss:rbp-0x70+var_64], rax</div><div class="line">0x00000001000011be 488B45D0                        mov        rax, qword [ss:rbp-0x70+var_64]</div><div class="line">0x00000001000011c2 4889C7                          mov        rdi, rax</div><div class="line">0x00000001000011c5 488B75A0                        mov        rsi, qword [ss:rbp-0x70+var_16]</div><div class="line">0x00000001000011c9 FF1511160000                    call       qword [ds:objc_msg_length]  ; @selector(length)</div><div class="line">0x00000001000011cf 488945C8                        mov        qword [ss:rbp-0x70+var_56], rax</div><div class="line">0x00000001000011d3 488B75C8                        mov        rsi, qword [ss:rbp-0x70+var_56]</div><div class="line">0x00000001000011d7 488B7DB0                        mov        rdi, qword [ss:rbp-0x70+var_32]</div><div class="line">0x00000001000011db B000                            mov        al, 0x0</div><div class="line">0x00000001000011dd E83A030000                      call       imp___stubs__NSLog</div><div class="line">0x00000001000011e2 48817DC80A000000                cmp        qword [ss:rbp-0x70+var_56], 0xa</div><div class="line">0x00000001000011ea 0F86BF000000                    jbe        0x1000012af     //判断密码长度是否大于10</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x00000001000011f0 48817DC80F000000                cmp        qword [ss:rbp-0x70+var_56], 0xf</div><div class="line">0x00000001000011f8 0F83B1000000                    jnc        0x1000012af //判断密码长度是否小于15</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x00000001000011fe 48817DD807000000                cmp        qword [ss:rbp-0x70+var_72], 0x7</div><div class="line">0x0000000100001206 0F86A3000000                    jbe        0x1000012af   //判断用户名长度是否大于7</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x000000010000120c 48817DD80F000000                cmp        qword [ss:rbp-0x70+var_72], 0xf</div><div class="line">0x0000000100001214 0F8395000000                    jnc        0x1000012af   // 判断用户名长度是否小于15</div><div class="line">                                       ; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: rax rcx rdx rbp rsi rdi</div><div class="line">0x000000010000121a 488D05CF150000                  lea        rax, qword [ds:objc_msg_isEqualToString_] ; @selector(isEqualToString:)</div><div class="line">0x0000000100001221 488D0D68170000                  lea        rcx, qword [ds:cfstring_]   ; @&quot;&quot;</div><div class="line">0x0000000100001228 488B15D9150000                  mov        rdx, qword [ds:bind__OBJC_CLASS_$_NSCharacterSet]</div><div class="line">0x000000010000122f 488B354A150000                  mov        rsi, qword [ds:objc_sel_alphanumericCharacterSet] ; @selector(alphanumericCharacterSet)</div><div class="line">0x0000000100001236 4889D7                          mov        rdi, rdx</div><div class="line">0x0000000100001239 48894598                        mov        qword [ss:rbp-0x70+var_8], rax</div><div class="line">0x000000010000123d 48894D90                        mov        qword [ss:rbp-0x70+var_0], rcx</div><div class="line">0x0000000100001241 E8E2020000                      call       imp___stubs__objc_msgSend     //获取字母和数字集合 NSCharacterSet *alphanumericSet = [ NSCharacterSetalphanumericCharacterSet ];</div><div class="line">0x0000000100001246 488945C0                        mov        qword [ss:rbp-0x70+var_48], rax</div><div class="line">0x000000010000124a 488B45D0                        mov        rax, qword [ss:rbp-0x70+var_64]</div><div class="line">0x000000010000124e 488B55C0                        mov        rdx, qword [ss:rbp-0x70+var_48]</div><div class="line">0x0000000100001252 488B352F150000                  mov        rsi, qword [ds:objc_sel_stringByTrimmingCharactersInSet_] ; @selector(stringByTrimmingCharactersInSet:)</div><div class="line">0x0000000100001259 4889C7                          mov        rdi, rax</div><div class="line">0x000000010000125c E8C7020000                      call       imp___stubs__objc_msgSend  //格式化密码，去除密码中含alphanumericSet中的字符 NSString *trimmedString = [passwdString stringByTrimmingCharactersInSet:alphanumericSet];</div><div class="line">0x0000000100001261 4889C7                          mov        rdi, rax</div><div class="line">0x0000000100001264 488B7598                        mov        rsi, qword [ss:rbp-0x70+var_8]</div><div class="line">0x0000000100001268 488B5590                        mov        rdx, qword [ss:rbp-0x70+var_0]</div><div class="line">0x000000010000126c FF157E150000                    call       qword [ds:objc_msg_isEqualToString_] ; @selector(isEqualToString:)//判断trimmedString是否和@“”空串相等</div><div class="line">0x0000000100001272 8845BF                          mov        byte [ss:rbp-0x70+var_47], al</div><div class="line">0x0000000100001275 807DBF00                        cmp        byte [ss:rbp-0x70+var_47], 0x0</div><div class="line">0x0000000100001279 0F8418000000                    je         0x100001297   //不等则显示错误</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi</div><div class="line">0x000000010000127f 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104]</div><div class="line">0x0000000100001283 488B3506150000                  mov        rsi, qword [ds:objc_sel_yes] ; @selector(yes)</div><div class="line">0x000000010000128a 4889C7                          mov        rdi, rax</div><div class="line">0x000000010000128d E896020000                      call       imp___stubs__objc_msgSend</div><div class="line">0x0000000100001292 E913000000                      jmp        0x1000012aa</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi</div><div class="line">0x0000000100001297 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104] ; XREF=0x100001279</div><div class="line">0x000000010000129b 488B35F6140000                  mov        rsi, qword [ds:objc_sel_no] ; @selector(no)</div><div class="line">0x00000001000012a2 4889C7                          mov        rdi, rax</div><div class="line">0x00000001000012a5 E87E020000                      call       imp___stubs__objc_msgSend</div><div class="line">                                       ; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x00000001000012aa E913000000                      jmp        0x1000012c2                ; XREF=0x100001292</div><div class="line">                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi</div><div class="line">0x00000001000012af 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104] ; XREF=0x1000011ea, 0x1000011f8, 0x100001206, 0x100001214</div><div class="line">0x00000001000012b3 488B35DE140000                  mov        rsi, qword [ds:objc_sel_no] ; @selector(no)</div><div class="line">0x00000001000012ba 4889C7                          mov        rdi, rax</div><div class="line">0x00000001000012bd E866020000                      call       imp___stubs__objc_msgSend</div><div class="line">                                       ; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: rsp rbp</div><div class="line">0x00000001000012c2 4883C470                        add        rsp, 0x70                  ; XREF=0x1000012aa</div><div class="line">0x00000001000012c6 5D                              pop        rbp</div><div class="line">0x00000001000012c7 C3                              ret</div></pre></td></tr></table></figure>
<h4 id="复原代码如下："><a href="#复原代码如下：" class="headerlink" title="复原代码如下："></a>复原代码如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *  用户名密码验证</div><div class="line"> *  用户名密码长度验证，密码字母和数字验证，密码只能包含数字和字母</div><div class="line"> *  @return 返回YES or NO</div><div class="line"> */</div><div class="line">-(BOOL)checkifisok&#123;</div><div class="line">    NSString* name = [nameTextField text];</div><div class="line">    NSString* serial = [serialTextField text];</div><div class="line">    int nameLength = [name length];</div><div class="line">    int serialLength = [serial length];</div><div class="line">    if(serialLength &gt; 10 &amp;&amp; serialLength &lt; 15)&#123;</div><div class="line">        if(nameLength &gt; 7 &amp;&amp; nameLength &lt; 15)&#123;</div><div class="line">            NSCharacterSet *alphanumericSet = [NSCharacterSet alphanumericCharacterSet];</div><div class="line">            NSString *trimmedString = [serial stringByTrimmingCharactersInSet:alphanumericSet];</div><div class="line">            if([trimmedString isEqualToString:@&quot;&quot;])&#123;</div><div class="line">                returnYES;</div><div class="line">            &#125;</div><div class="line">        &#125;else&#123;</div><div class="line">            returnNO</div><div class="line">        &#125;</div><div class="line">    &#125;else&#123;</div><div class="line">        returnNO;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="第二个使用lldb动态调试："><a href="#第二个使用lldb动态调试：" class="headerlink" title="第二个使用lldb动态调试："></a>第二个使用lldb动态调试：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">lldb crackme2.app</div><div class="line">r</div><div class="line">ctl+c</div><div class="line">br s -a 0x2a9e</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div></pre></td><td class="code"><pre><div class="line">0x00002a9e 55                              push      ebp</div><div class="line">0x00002a9f 89E5                            mov       ebp,esp</div><div class="line">0x00002aa1 57                              push      edi</div><div class="line">0x00002aa2 56                              push      esi</div><div class="line">0x00002aa3 53                              push      ebx</div><div class="line">0x00002aa4 83EC3C                          sub       esp,0x3c</div><div class="line">0x00002aa7 A140400000                      mov       eax, dword [ds:objc_msg_length]    ; @selector(length)</div><div class="line">0x00002aac 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002ab0 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]</div><div class="line">0x00002ab3 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002ab6 E8A3250000                      call       imp___jump_table__objc_msgSend</div><div class="line">0x00002abb 83F808                          cmp        eax,0x8   //判断注册码长度是否为8位</div><div class="line">0x00002abe 0F858A010000                    jne       0x2c4e  //不等跳往错误提示</div><div class="line">                                       ; Basic Block Input Regs: ecx ebx ebp -  Killed Regs: eax ecx ebx esp ebp esi edi</div><div class="line">0x00002ac4 A144400000                      mov       eax, dword [ds:objc_msg_lossyCString]; @selector(lossyCString)</div><div class="line">0x00002ac9 BE04000000                      mov       esi,0x4   //esi初始化为4</div><div class="line">0x00002ace 31DB                            xor       ebx,ebx</div><div class="line">0x00002ad0 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002ad4 8B4514                          mov       eax, dword [ss:ebp-0x48+arg_C]</div><div class="line">0x00002ad7 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002ada E87F250000                      call       imp___jump_table__objc_msgSend</div><div class="line">0x00002adf 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002ae2 89C7                            mov       edi,eax</div><div class="line">0x00002ae4 E87A250000                      call       imp___jump_table__strlen</div><div class="line">0x00002ae9 31C9                            xor       ecx,ecx</div><div class="line">0x00002aeb 8945D0                          mov        dword [ss:ebp-0x48+var_24],eax</div><div class="line">0x00002aee EB37                            jmp       0x2b27</div><div class="line">                                       ; Basic Block Input Regs: ebx esi edi -  Killed Regs: eax ecx edx ebx ebp esi</div><div class="line">0x00002af0 0FBE041F                        movsx     eax, byte [ds:edi+ebx]             ; XREF=0x2b2a   //取用户名的一个字符</div><div class="line">0x00002af4 43                              inc       ebx  //循环累加器</div><div class="line">0x00002af5 0FAFC6                          imul      eax,esi  //取出来的字符与esi相乘</div><div class="line">0x00002af8 83C604                          add       esi,0x4  //esi+4</div><div class="line">0x00002afb 89C2                            mov       edx,eax</div><div class="line">0x00002afd C1E204                          shl       edx,0x4  //edx &lt;&lt; 0x4</div><div class="line">0x00002b00 29C2                            sub       edx,eax</div><div class="line">0x00002b02 B8AD8BDB68                      mov       eax,0x68db8bad</div><div class="line">0x00002b07 8D8C0A9A020000                  lea       ecx, dword [ds:edx+ecx+0x29a]</div><div class="line">0x00002b0e F7E9                            imul      ecx</div><div class="line">0x00002b10 89C8                            mov       eax,ecx</div><div class="line">0x00002b12 C1F81F                          sar       eax,0x1f</div><div class="line">0x00002b15 C1FA0C                          sar       edx,0xc</div><div class="line">0x00002b18 29C2                            sub       edx,eax</div><div class="line">0x00002b1a 89C8                            mov       eax,ecx</div><div class="line">0x00002b1c 69D210270000                    imul      edx,edx,0x2710</div><div class="line">0x00002b22 29D0                            sub       eax,edx</div><div class="line">0x00002b24 8945E0                          mov        dword [ss:ebp-0x48+var_40],eax</div><div class="line">                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x00002b27 395DD0                          cmp        dword [ss:ebp-0x48+var_24],ebx   ; XREF=0x2aee</div><div class="line">0x00002b2a 77C4                            jnbe      0x2af0</div><div class="line">                                       ; Basic Block Input Regs: ecx ebx ebp edi -  Killed Regs: eax ecx ebx esp ebp esi</div><div class="line">0x00002b2c 8B45E0                          mov       eax, dword [ss:ebp-0x48+var_40]</div><div class="line">0x00002b2f BE04000000                      mov       esi,0x4</div><div class="line">0x00002b34 31DB                            xor       ebx,ebx</div><div class="line">0x00002b36 C744240878300000                mov        dword [ss:esp+0x8],0x3078         ; @&quot;%i&quot;</div><div class="line">0x00002b3e 8944240C                        mov        dword [ss:esp+0xc],eax</div><div class="line">0x00002b42 A128400000                      mov       eax, dword [ds:objc_msg_stringWithFormat_]; @selector(stringWithFormat:)</div><div class="line">0x00002b47 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002b4b A154400000                      mov       eax, dword [ds:cls_NSString]</div><div class="line">0x00002b50 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002b53 E806250000                      call       imp___jump_table__objc_msgSend   //将结果格式化为NSString</div><div class="line">0x00002b58 893C24                          mov        dword [ss:esp],edi</div><div class="line">0x00002b5b 8945D8                          mov        dword [ss:ebp-0x48+var_32],eax</div><div class="line">0x00002b5e E800250000                      call       imp___jump_table__strlen</div><div class="line">0x00002b63 31C9                            xor       ecx,ecx</div><div class="line">0x00002b65 8945D4                          mov        dword [ss:ebp-0x48+var_28],eax</div><div class="line">0x00002b68 EB32                            jmp       0x2b9c</div><div class="line">                                       ; Basic Block Input Regs: ebx esi edi -  Killed Regs: eax ecx edx ebx ebp esi</div><div class="line">0x00002b6a 0FBE041F                        movsx     eax, byte [ds:edi+ebx]             ; XREF=0x2b9f</div><div class="line">0x00002b6e 43                              inc       ebx</div><div class="line">0x00002b6f 0FAFC6                          imul      eax,esi</div><div class="line">0x00002b72 83C608                          add       esi,0x8</div><div class="line">0x00002b75 8D1480                          lea       edx, dword [ds:eax+eax*4]</div><div class="line">0x00002b78 8D54502D                        lea       edx, dword [ds:eax+edx*2+0x2d]</div><div class="line">0x00002b7c B8AD8BDB68                      mov       eax,0x68db8bad</div><div class="line">0x00002b81 01D1                            add       ecx,edx</div><div class="line">0x00002b83 F7E9                            imul      ecx</div><div class="line">0x00002b85 89C8                            mov       eax,ecx</div><div class="line">0x00002b87 C1F81F                          sar       eax,0x1f</div><div class="line">0x00002b8a C1FA0C                          sar       edx,0xc</div><div class="line">0x00002b8d 29C2                            sub       edx,eax</div><div class="line">0x00002b8f 89C8                            mov       eax,ecx</div><div class="line">0x00002b91 69D210270000                    imul      edx,edx,0x2710</div><div class="line">0x00002b97 29D0                            sub       eax,edx</div><div class="line">0x00002b99 8945E4                          mov        dword [ss:ebp-0x48+var_44],eax</div><div class="line">                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: &lt;nothing&gt;</div><div class="line">0x00002b9c 3B5DD4                          cmp       ebx, dword [ss:ebp-0x48+var_28]    ; XREF=0x2b68</div><div class="line">0x00002b9f 72C9                            jc        0x2b6a</div><div class="line">                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: eax ebx esp ebp esi edi</div><div class="line">0x00002ba1 8B45E4                          mov       eax, dword [ss:ebp-0x48+var_44]</div><div class="line">0x00002ba4 BE04000000                      mov       esi,0x4</div><div class="line">0x00002ba9 31DB                            xor       ebx,ebx</div><div class="line">0x00002bab C744240878300000                mov        dword [ss:esp+0x8],0x3078         ; @&quot;%i&quot;</div><div class="line">0x00002bb3 BF04000000                      mov       edi,0x4</div><div class="line">0x00002bb8 8944240C                        mov        dword [ss:esp+0xc],eax</div><div class="line">0x00002bbc A128400000                      mov       eax, dword [ds:objc_msg_stringWithFormat_]; @selector(stringWithFormat:)</div><div class="line">0x00002bc1 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002bc5 A154400000                      mov       eax, dword [ds:cls_NSString]</div><div class="line">0x00002bca 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002bcd E88C240000                      call       imp___jump_table__objc_msgSend //将结果格式化为NSString</div><div class="line">0x00002bd2 895C2408                        mov        dword [ss:esp+0x8],ebx</div><div class="line">0x00002bd6 8974240C                        mov        dword [ss:esp+0xc],esi</div><div class="line">0x00002bda 8945DC                          mov        dword [ss:ebp-0x48+var_36],eax</div><div class="line">0x00002bdd A148400000                      mov       eax, dword [ds:objc_msg_substringWithRange_]; @selector(substringWithRange:)</div><div class="line">0x00002be2 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002be6 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]</div><div class="line">0x00002be9 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002bec E86D240000                      call       imp___jump_table__objc_msgSend //截取密码前4位验证</div><div class="line">0x00002bf1 89742408                        mov        dword [ss:esp+0x8],esi</div><div class="line">0x00002bf5 897C240C                        mov        dword [ss:esp+0xc],edi</div><div class="line">0x00002bf9 89C3                            mov       ebx,eax</div><div class="line">0x00002bfb A148400000                      mov       eax, dword [ds:objc_msg_substringWithRange_]; @selector(substringWithRange:)</div><div class="line">0x00002c00 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002c04 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]</div><div class="line">0x00002c07 890424                          mov        dword [ss:esp],eax</div><div class="line">0x00002c0a E84F240000                      call       imp___jump_table__objc_msgSend//截取密码后4位验证</div><div class="line">0x00002c0f 891C24                          mov        dword [ss:esp],ebx</div><div class="line">0x00002c12 89C6                            mov       esi,eax</div><div class="line">0x00002c14 8B45D8                          mov       eax, dword [ss:ebp-0x48+var_32]</div><div class="line">0x00002c17 89442408                        mov        dword [ss:esp+0x8],eax</div><div class="line">0x00002c1b A108400000                      mov       eax, dword [ds:objc_msg_isEqual_]  ; @selector(isEqual:)</div><div class="line">0x00002c20 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002c24 E835240000                      call       imp___jump_table__objc_msgSend //判断是否相等</div><div class="line">0x00002c29 84C0                            test      al,al</div><div class="line">0x00002c2b 7421                            je        0x2c4e</div><div class="line">                                       ; Basic Block Input Regs: ebp esi -  Killed Regs: eax edx esp</div><div class="line">0x00002c2d 8B45DC                          mov       eax, dword [ss:ebp-0x48+var_36]</div><div class="line">0x00002c30 893424                          mov        dword [ss:esp],esi</div><div class="line">0x00002c33 89442408                        mov        dword [ss:esp+0x8],eax</div><div class="line">0x00002c37 A108400000                      mov       eax, dword [ds:objc_msg_isEqual_]  ; @selector(isEqual:)</div><div class="line">0x00002c3c 89442404                        mov        dword [ss:esp+0x4],eax</div><div class="line">0x00002c40 E819240000                      call       imp___jump_table__objc_msgSend//判断是否相等</div><div class="line">0x00002c45 BA01000000                      mov       edx,0x1</div><div class="line">0x00002c4a 84C0                            test      al,al</div><div class="line">0x00002c4c 7502                            jne       0x2c50</div><div class="line">                                       ; Basic Block Input Regs: edx -  Killed Regs: edx</div><div class="line">0x00002c4e 31D2                            xor       edx,edx                           ; XREF=0x2abe, 0x2c2b</div><div class="line">                                       ; Basic Block Input Regs: edx -  Killed Regs: eax ebx esp esi edi</div><div class="line">0x00002c50 83C43C                          add       esp,0x3c                         ; XREF=0x2c4c</div><div class="line">0x00002c53 89D0                            mov       eax,edx</div><div class="line">0x00002c55 5B                              pop       ebx</div><div class="line">0x00002c56 5E                              pop       esi</div><div class="line">0x00002c57 5F                              pop       edi</div><div class="line">0x00002c58 C9                              leave     </div><div class="line">0x00002c59 C3                              ret</div></pre></td></tr></table></figure>
<p>####keygen代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">int main(int argc, constchar * argv[]) &#123;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">       </div><div class="line">        unsignedlong nameLength = strlen(argv[1]);</div><div class="line">        constchar* index = argv[1];</div><div class="line">        unsignedint eax = 0;</div><div class="line">        int ecx=0,edx=0,esi = 4;</div><div class="line">        int serial_1=0;</div><div class="line">        long constValue =  0x68db8bad;</div><div class="line">        for (int i = 0; i&lt;nameLength; i++) &#123;</div><div class="line">            eax = (int)(*index);</div><div class="line">            eax = eax * esi;</div><div class="line">            esi+=4;</div><div class="line">            edx = (eax &lt;&lt; 0x4) - eax;</div><div class="line">            ecx = edx + ecx+0x29a;</div><div class="line">            edx = constValue*ecx &gt;&gt; 32;</div><div class="line">            serial_1 = ecx - ((edx &gt;&gt; 0xc)-(ecx &gt;&gt; 0x1f)) * 0x2710;</div><div class="line">            index++;</div><div class="line">           </div><div class="line">        &#125;</div><div class="line">        int serial_2=0;</div><div class="line">        index = argv[1];</div><div class="line">        eax = 0,ecx=0,edx=0,esi = 4;</div><div class="line">       </div><div class="line">        for (int i = 0; i&lt;nameLength; i++) &#123;</div><div class="line">            eax = (int)(*index);</div><div class="line">            eax = eax * esi;</div><div class="line">            esi+=8;</div><div class="line">            edx = eax+(eax+eax*4)*2+0x2d;</div><div class="line">            ecx += edx;</div><div class="line">            edx = constValue*ecx &gt;&gt; 32;</div><div class="line">            serial_2 = ecx - ((edx &gt;&gt; 0xc) - (ecx &gt;&gt; 0x1f)) * 0x2710;</div><div class="line">            index++;</div><div class="line">        &#125;</div><div class="line">        NSLog(@&quot;\nname:%s\nserial:%d%d&quot;,argv[1],serial_1,serial_2);</div><div class="line">    &#125;</div><div class="line">    return0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;工具列表：&quot;&gt;&lt;a href=&quot;#工具列表：&quot; class=&quot;headerlink&quot; title=&quot;工具列表：&quot;&gt;&lt;/a&gt;工具列表：&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Hopper disassembler（静态分析）&lt;/li&gt;
&lt;li&gt;lldb （动态调试）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;先来个最简单的，直接用Hopper disassembler分析：&lt;br&gt;直接把第一个crackme拖到Hopper里面，看下左边窗口，看下这个crackme的Labels&lt;/p&gt;
&lt;p&gt;很容易就找到这个methed实现&lt;code&gt;methImpl_AppDelegate_checkifisok_&lt;/code&gt;&lt;br&gt;点击它看下汇编：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;81&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;82&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;83&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;84&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;85&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;86&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;87&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;88&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;89&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;90&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;91&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;92&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;93&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;94&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;95&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;96&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;97&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;98&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;99&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;100&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;101&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;102&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;103&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001110 55                              push       rbp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001111 4889E5                          mov        rbp, rsp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001114 4883EC70                        sub        rsp, 0x70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001118 488D0551180000                  lea        rax, qword [ds:cfstring_Length_of_the_serial_string_is___lx] ; @&amp;quot;Length of the serial string is: %lx&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000111f 488D0DBA160000                  lea        rcx, qword [ds:objc_msg_length] ; @selector(length)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001126 4C8D0523180000                  lea        r8, qword [ds:cfstring_Length_of_the_name_string_is___lx] ; @&amp;quot;Length of the name string is: %lx&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000112d 4C8D0DFC170000                  lea        r9, qword [ds:cfstring_uh_] ; @&amp;quot;uh?&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001134 48897DF8                        mov        qword [ss:rbp-0x70+var_104], rdi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001138 488975F0                        mov        qword [ss:rbp-0x70+var_96], rsi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000113c 488955E8                        mov        qword [ss:rbp-0x70+var_88], rdx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001140 4C89CF                          mov        rdi, r9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001143 488945B0                        mov        qword [ss:rbp-0x70+var_32], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001147 B000                            mov        al, 0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001149 4C8945A8                        mov        qword [ss:rbp-0x70+var_24], r8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000114d 48894DA0                        mov        qword [ss:rbp-0x70+var_16], rcx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001151 E8C6030000                      call       imp___stubs__NSLog&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001156 488B4DF8                        mov        rcx, qword [ss:rbp-0x70+var_104]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000115a 488B152F190000                  mov        rdx, qword [ds:0x100002a90]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001161 488B0C11                        mov        rcx, qword [ds:rcx+rdx]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001165 488B350C160000                  mov        rsi, qword [ds:objc_sel_stringValue] ; @selector(stringValue)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000116c 4889CF                          mov        rdi, rcx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000116f E8B4030000                      call       imp___stubs__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001174 488945E0                        mov        qword [ss:rbp-0x70+var_80], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001178 488B45E0                        mov        rax, qword [ss:rbp-0x70+var_80]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000117c 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000117f 488B75A0                        mov        rsi, qword [ss:rbp-0x70+var_16]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001183 FF1557160000                    call       qword [ds:objc_msg_length]  ; @selector(length)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001189 488945D8                        mov        qword [ss:rbp-0x70+var_72], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000118d 488B75D8                        mov        rsi, qword [ss:rbp-0x70+var_72]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001191 488B7DA8                        mov        rdi, qword [ss:rbp-0x70+var_24]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001195 B000                            mov        al, 0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001197 E880030000                      call       imp___stubs__NSLog&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000119c 488B4DF8                        mov        rcx, qword [ss:rbp-0x70+var_104]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011a0 488B15F1180000                  mov        rdx, qword [ds:0x100002a98]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011a7 488B0C11                        mov        rcx, qword [ds:rcx+rdx]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011ab 488B35C6150000                  mov        rsi, qword [ds:objc_sel_stringValue] ; @selector(stringValue)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011b2 4889CF                          mov        rdi, rcx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011b5 E86E030000                      call       imp___stubs__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011ba 488945D0                        mov        qword [ss:rbp-0x70+var_64], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011be 488B45D0                        mov        rax, qword [ss:rbp-0x70+var_64]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011c2 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011c5 488B75A0                        mov        rsi, qword [ss:rbp-0x70+var_16]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011c9 FF1511160000                    call       qword [ds:objc_msg_length]  ; @selector(length)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011cf 488945C8                        mov        qword [ss:rbp-0x70+var_56], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011d3 488B75C8                        mov        rsi, qword [ss:rbp-0x70+var_56]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011d7 488B7DB0                        mov        rdi, qword [ss:rbp-0x70+var_32]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011db B000                            mov        al, 0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011dd E83A030000                      call       imp___stubs__NSLog&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011e2 48817DC80A000000                cmp        qword [ss:rbp-0x70+var_56], 0xa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011ea 0F86BF000000                    jbe        0x1000012af     //判断密码长度是否大于10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011f0 48817DC80F000000                cmp        qword [ss:rbp-0x70+var_56], 0xf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011f8 0F83B1000000                    jnc        0x1000012af //判断密码长度是否小于15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000011fe 48817DD807000000                cmp        qword [ss:rbp-0x70+var_72], 0x7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001206 0F86A3000000                    jbe        0x1000012af   //判断用户名长度是否大于7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000120c 48817DD80F000000                cmp        qword [ss:rbp-0x70+var_72], 0xf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001214 0F8395000000                    jnc        0x1000012af   // 判断用户名长度是否小于15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: &amp;lt;nothing&amp;gt; -  Killed Regs: rax rcx rdx rbp rsi rdi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000121a 488D05CF150000                  lea        rax, qword [ds:objc_msg_isEqualToString_] ; @selector(isEqualToString:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001221 488D0D68170000                  lea        rcx, qword [ds:cfstring_]   ; @&amp;quot;&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001228 488B15D9150000                  mov        rdx, qword [ds:bind__OBJC_CLASS_$_NSCharacterSet]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000122f 488B354A150000                  mov        rsi, qword [ds:objc_sel_alphanumericCharacterSet] ; @selector(alphanumericCharacterSet)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001236 4889D7                          mov        rdi, rdx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001239 48894598                        mov        qword [ss:rbp-0x70+var_8], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000123d 48894D90                        mov        qword [ss:rbp-0x70+var_0], rcx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001241 E8E2020000                      call       imp___stubs__objc_msgSend     //获取字母和数字集合 NSCharacterSet *alphanumericSet = [ NSCharacterSetalphanumericCharacterSet ];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001246 488945C0                        mov        qword [ss:rbp-0x70+var_48], rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000124a 488B45D0                        mov        rax, qword [ss:rbp-0x70+var_64]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000124e 488B55C0                        mov        rdx, qword [ss:rbp-0x70+var_48]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001252 488B352F150000                  mov        rsi, qword [ds:objc_sel_stringByTrimmingCharactersInSet_] ; @selector(stringByTrimmingCharactersInSet:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001259 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000125c E8C7020000                      call       imp___stubs__objc_msgSend  //格式化密码，去除密码中含alphanumericSet中的字符 NSString *trimmedString = [passwdString stringByTrimmingCharactersInSet:alphanumericSet];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001261 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001264 488B7598                        mov        rsi, qword [ss:rbp-0x70+var_8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001268 488B5590                        mov        rdx, qword [ss:rbp-0x70+var_0]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000126c FF157E150000                    call       qword [ds:objc_msg_isEqualToString_] ; @selector(isEqualToString:)//判断trimmedString是否和@“”空串相等&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001272 8845BF                          mov        byte [ss:rbp-0x70+var_47], al&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001275 807DBF00                        cmp        byte [ss:rbp-0x70+var_47], 0x0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001279 0F8418000000                    je         0x100001297   //不等则显示错误&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000127f 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001283 488B3506150000                  mov        rsi, qword [ds:objc_sel_yes] ; @selector(yes)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000128a 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000128d E896020000                      call       imp___stubs__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001292 E913000000                      jmp        0x1000012aa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x0000000100001297 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104] ; XREF=0x100001279&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x000000010000129b 488B35F6140000                  mov        rsi, qword [ds:objc_sel_no] ; @selector(no)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012a2 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012a5 E87E020000                      call       imp___stubs__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: &amp;lt;nothing&amp;gt; -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012aa E913000000                      jmp        0x1000012c2                ; XREF=0x100001292&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: rbp -  Killed Regs: rax rsi rdi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012af 488B45F8                        mov        rax, qword [ss:rbp-0x70+var_104] ; XREF=0x1000011ea, 0x1000011f8, 0x100001206, 0x100001214&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012b3 488B35DE140000                  mov        rsi, qword [ds:objc_sel_no] ; @selector(no)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012ba 4889C7                          mov        rdi, rax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012bd E866020000                      call       imp___stubs__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: &amp;lt;nothing&amp;gt; -  Killed Regs: rsp rbp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012c2 4883C470                        add        rsp, 0x70                  ; XREF=0x1000012aa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012c6 5D                              pop        rbp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00000001000012c7 C3                              ret&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;复原代码如下：&quot;&gt;&lt;a href=&quot;#复原代码如下：&quot; class=&quot;headerlink&quot; title=&quot;复原代码如下：&quot;&gt;&lt;/a&gt;复原代码如下：&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;/**&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; *  用户名密码验证&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; *  用户名密码长度验证，密码字母和数字验证，密码只能包含数字和字母&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; *  @return 返回YES or NO&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-(BOOL)checkifisok&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    NSString* name = [nameTextField text];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    NSString* serial = [serialTextField text];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    int nameLength = [name length];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    int serialLength = [serial length];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    if(serialLength &amp;gt; 10 &amp;amp;&amp;amp; serialLength &amp;lt; 15)&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        if(nameLength &amp;gt; 7 &amp;amp;&amp;amp; nameLength &amp;lt; 15)&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            NSCharacterSet *alphanumericSet = [NSCharacterSet alphanumericCharacterSet];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            NSString *trimmedString = [serial stringByTrimmingCharactersInSet:alphanumericSet];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            if([trimmedString isEqualToString:@&amp;quot;&amp;quot;])&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                returnYES;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;else&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            returnNO&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;else&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        returnNO;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;第二个使用lldb动态调试：&quot;&gt;&lt;a href=&quot;#第二个使用lldb动态调试：&quot; class=&quot;headerlink&quot; title=&quot;第二个使用lldb动态调试：&quot;&gt;&lt;/a&gt;第二个使用lldb动态调试：&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;lldb crackme2.app&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ctl+c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;br s -a 0x2a9e&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;81&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;82&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;83&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;84&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;85&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;86&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;87&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;88&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;89&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;90&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;91&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;92&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;93&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;94&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;95&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;96&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;97&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;98&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;99&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;100&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;101&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;102&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;103&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;104&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;105&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;106&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;107&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;108&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;109&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;110&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;111&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;112&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;113&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;114&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;115&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;116&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;117&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;118&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;119&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;120&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;121&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;122&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;123&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;124&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;125&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;126&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;127&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;128&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;129&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;130&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;131&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;132&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;133&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;134&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;135&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;136&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;137&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;138&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;139&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;140&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;141&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;142&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;143&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;144&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;0x00002a9e 55                              push      ebp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002a9f 89E5                            mov       ebp,esp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aa1 57                              push      edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aa2 56                              push      esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aa3 53                              push      ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aa4 83EC3C                          sub       esp,0x3c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aa7 A140400000                      mov       eax, dword [ds:objc_msg_length]    ; @selector(length)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aac 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ab0 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ab3 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ab6 E8A3250000                      call       imp___jump_table__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002abb 83F808                          cmp        eax,0x8   //判断注册码长度是否为8位&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002abe 0F858A010000                    jne       0x2c4e  //不等跳往错误提示&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ecx ebx ebp -  Killed Regs: eax ecx ebx esp ebp esi edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ac4 A144400000                      mov       eax, dword [ds:objc_msg_lossyCString]; @selector(lossyCString)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ac9 BE04000000                      mov       esi,0x4   //esi初始化为4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ace 31DB                            xor       ebx,ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ad0 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ad4 8B4514                          mov       eax, dword [ss:ebp-0x48+arg_C]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ad7 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ada E87F250000                      call       imp___jump_table__objc_msgSend&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002adf 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ae2 89C7                            mov       edi,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ae4 E87A250000                      call       imp___jump_table__strlen&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ae9 31C9                            xor       ecx,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aeb 8945D0                          mov        dword [ss:ebp-0x48+var_24],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002aee EB37                            jmp       0x2b27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebx esi edi -  Killed Regs: eax ecx edx ebx ebp esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002af0 0FBE041F                        movsx     eax, byte [ds:edi+ebx]             ; XREF=0x2b2a   //取用户名的一个字符&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002af4 43                              inc       ebx  //循环累加器&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002af5 0FAFC6                          imul      eax,esi  //取出来的字符与esi相乘&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002af8 83C604                          add       esi,0x4  //esi+4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002afb 89C2                            mov       edx,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002afd C1E204                          shl       edx,0x4  //edx &amp;lt;&amp;lt; 0x4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b00 29C2                            sub       edx,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b02 B8AD8BDB68                      mov       eax,0x68db8bad&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b07 8D8C0A9A020000                  lea       ecx, dword [ds:edx+ecx+0x29a]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b0e F7E9                            imul      ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b10 89C8                            mov       eax,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b12 C1F81F                          sar       eax,0x1f&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b15 C1FA0C                          sar       edx,0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b18 29C2                            sub       edx,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b1a 89C8                            mov       eax,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b1c 69D210270000                    imul      edx,edx,0x2710&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b22 29D0                            sub       eax,edx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b24 8945E0                          mov        dword [ss:ebp-0x48+var_40],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b27 395DD0                          cmp        dword [ss:ebp-0x48+var_24],ebx   ; XREF=0x2aee&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b2a 77C4                            jnbe      0x2af0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ecx ebx ebp edi -  Killed Regs: eax ecx ebx esp ebp esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b2c 8B45E0                          mov       eax, dword [ss:ebp-0x48+var_40]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b2f BE04000000                      mov       esi,0x4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b34 31DB                            xor       ebx,ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b36 C744240878300000                mov        dword [ss:esp+0x8],0x3078         ; @&amp;quot;%i&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b3e 8944240C                        mov        dword [ss:esp+0xc],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b42 A128400000                      mov       eax, dword [ds:objc_msg_stringWithFormat_]; @selector(stringWithFormat:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b47 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b4b A154400000                      mov       eax, dword [ds:cls_NSString]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b50 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b53 E806250000                      call       imp___jump_table__objc_msgSend   //将结果格式化为NSString&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b58 893C24                          mov        dword [ss:esp],edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b5b 8945D8                          mov        dword [ss:ebp-0x48+var_32],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b5e E800250000                      call       imp___jump_table__strlen&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b63 31C9                            xor       ecx,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b65 8945D4                          mov        dword [ss:ebp-0x48+var_28],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b68 EB32                            jmp       0x2b9c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebx esi edi -  Killed Regs: eax ecx edx ebx ebp esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b6a 0FBE041F                        movsx     eax, byte [ds:edi+ebx]             ; XREF=0x2b9f&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b6e 43                              inc       ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b6f 0FAFC6                          imul      eax,esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b72 83C608                          add       esi,0x8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b75 8D1480                          lea       edx, dword [ds:eax+eax*4]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b78 8D54502D                        lea       edx, dword [ds:eax+edx*2+0x2d]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b7c B8AD8BDB68                      mov       eax,0x68db8bad&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b81 01D1                            add       ecx,edx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b83 F7E9                            imul      ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b85 89C8                            mov       eax,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b87 C1F81F                          sar       eax,0x1f&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b8a C1FA0C                          sar       edx,0xc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b8d 29C2                            sub       edx,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b8f 89C8                            mov       eax,ecx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b91 69D210270000                    imul      edx,edx,0x2710&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b97 29D0                            sub       eax,edx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b99 8945E4                          mov        dword [ss:ebp-0x48+var_44],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: &amp;lt;nothing&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b9c 3B5DD4                          cmp       ebx, dword [ss:ebp-0x48+var_28]    ; XREF=0x2b68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002b9f 72C9                            jc        0x2b6a&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebx ebp -  Killed Regs: eax ebx esp ebp esi edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ba1 8B45E4                          mov       eax, dword [ss:ebp-0x48+var_44]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ba4 BE04000000                      mov       esi,0x4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002ba9 31DB                            xor       ebx,ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bab C744240878300000                mov        dword [ss:esp+0x8],0x3078         ; @&amp;quot;%i&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bb3 BF04000000                      mov       edi,0x4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bb8 8944240C                        mov        dword [ss:esp+0xc],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bbc A128400000                      mov       eax, dword [ds:objc_msg_stringWithFormat_]; @selector(stringWithFormat:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bc1 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bc5 A154400000                      mov       eax, dword [ds:cls_NSString]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bca 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bcd E88C240000                      call       imp___jump_table__objc_msgSend //将结果格式化为NSString&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bd2 895C2408                        mov        dword [ss:esp+0x8],ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bd6 8974240C                        mov        dword [ss:esp+0xc],esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bda 8945DC                          mov        dword [ss:ebp-0x48+var_36],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bdd A148400000                      mov       eax, dword [ds:objc_msg_substringWithRange_]; @selector(substringWithRange:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002be2 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002be6 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002be9 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bec E86D240000                      call       imp___jump_table__objc_msgSend //截取密码前4位验证&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bf1 89742408                        mov        dword [ss:esp+0x8],esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bf5 897C240C                        mov        dword [ss:esp+0xc],edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bf9 89C3                            mov       ebx,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002bfb A148400000                      mov       eax, dword [ds:objc_msg_substringWithRange_]; @selector(substringWithRange:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c00 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c04 8B4510                          mov       eax, dword [ss:ebp-0x48+arg_8]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c07 890424                          mov        dword [ss:esp],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c0a E84F240000                      call       imp___jump_table__objc_msgSend//截取密码后4位验证&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c0f 891C24                          mov        dword [ss:esp],ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c12 89C6                            mov       esi,eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c14 8B45D8                          mov       eax, dword [ss:ebp-0x48+var_32]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c17 89442408                        mov        dword [ss:esp+0x8],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c1b A108400000                      mov       eax, dword [ds:objc_msg_isEqual_]  ; @selector(isEqual:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c20 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c24 E835240000                      call       imp___jump_table__objc_msgSend //判断是否相等&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c29 84C0                            test      al,al&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c2b 7421                            je        0x2c4e&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: ebp esi -  Killed Regs: eax edx esp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c2d 8B45DC                          mov       eax, dword [ss:ebp-0x48+var_36]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c30 893424                          mov        dword [ss:esp],esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c33 89442408                        mov        dword [ss:esp+0x8],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c37 A108400000                      mov       eax, dword [ds:objc_msg_isEqual_]  ; @selector(isEqual:)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c3c 89442404                        mov        dword [ss:esp+0x4],eax&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c40 E819240000                      call       imp___jump_table__objc_msgSend//判断是否相等&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c45 BA01000000                      mov       edx,0x1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c4a 84C0                            test      al,al&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c4c 7502                            jne       0x2c50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: edx -  Killed Regs: edx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c4e 31D2                            xor       edx,edx                           ; XREF=0x2abe, 0x2c2b&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                                       ; Basic Block Input Regs: edx -  Killed Regs: eax ebx esp esi edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c50 83C43C                          add       esp,0x3c                         ; XREF=0x2c4c&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c53 89D0                            mov       eax,edx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c55 5B                              pop       ebx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c56 5E                              pop       esi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c57 5F                              pop       edi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c58 C9                              leave     &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;0x00002c59 C3                              ret&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="BLOG" scheme="http://www.moesoft.com/categories/BLOG/"/>
    
    
      <category term="mac" scheme="http://www.moesoft.com/tags/mac/"/>
    
      <category term="crackme" scheme="http://www.moesoft.com/tags/crackme/"/>
    
      <category term="hopper" scheme="http://www.moesoft.com/tags/hopper/"/>
    
  </entry>
  
</feed>
