<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 2015第2届移动安全挑战赛iOS第二题分析 · 小葡萄爸爸滴博客</title><!--//- var desc = page.desc || page.title + ' - ' + config.author;--><!--//meta(name="description", content=desc)-->            <meta name="description" content="1234567891011121314151617181920212223242526272829303132saic sruc cdevsw pf_cdevsw = 123;	/ open /	pfopen,	/ cose /	pfcose,	/ read /	eno_rdwr,	/ wrie /	eno_rdwr,	/ ioc /	pfioc,	/ sop /	eno_sop,	/ rese /	eno_rese,	/ y /	NULL,	/ seec /	eno_seec,	/ mmap /	eno_mmap,	/ sraegy /	eno_sra,	/ gec /	eno_gec,	/ puc /	eno_puc,	/ ype /	0125;;voidpfinivoid123;......	maj = cdevsw_addPF_CDEV_MAJOR, amp;pf_cdevsw;	if maj == -1 123;		prinfquo;s: faied o aocae major number!\\\\\\\\nquo;, __func__;		reurn;	125;	void devfs_make_nodemakedevmaj, PFDEV_PF, DEVFS_CHAR,	    UID_ROOT, GID_WHEEL, 0600, quo;pfquo;, 0;	void devfs_make_nodemakedevmaj, PFDEV_PFM, DEVFS_CHAR,	    UID_ROOT, GID_WHEEL, 0600, quo;pfmquo;, 0;......125;;1234567891011121314151617181920212223环境：iPhone5CA1529 iOS 8.4 kernecache ，解密后的kernecache见附件求得下列地址减去kasr：1设备/dev/random，对应结构体cdevsw中d_read, d_wrie, d_ioc在题目给出kernecache中的地址;3设备/dev/pmx，对应结构体cdevsw中d_read, d_wrie, d_ioc在题目给出kernecache中的地址">
            <meta name="keywords" content="apos,803,bdf,800,bde,ptmx,80,quot,cdevsw,add">        <meta name="theme-color" content="db3333"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.moesoft.com/atom.xml" title="小葡萄爸爸滴博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/moesoftch" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/creantan" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">2015第2届移动安全挑战赛iOS第二题分析</h1><div class="post-info">Sep 5, 2017</div><div class="post-content"><p>第二题题目如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">环境：iPhone5C(A1529) iOS 8.4 kernelcache ，解密后的kernelcache见附件</div><div class="line"></div><div class="line">求得下列地址（减去kaslr）：</div><div class="line">(1)设备/dev/random，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line">(2)设备/dev/pf，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line">(3)设备/dev/ptmx，对应结构体cdevsw中d_read, d_write, d_ioctl在题目给出kernelcache中的地址。</div><div class="line"></div><div class="line">假设上述地址的结果是：</div><div class="line">/dev/random</div><div class="line">d_read:0x80001231</div><div class="line">d_write:0x80001253</div><div class="line">d_ioctl:0x80001275</div><div class="line">/dev/pf</div><div class="line">d_read:0x80201297</div><div class="line">d_write:0x802012b9</div><div class="line">d_ioctl:0x801012db</div><div class="line">/dev/ptmx</div><div class="line">d_read:0x802012ed</div><div class="line">d_write:0x802012ff</div><div class="line">d_ioctl:0x80201211</div><div class="line"></div><div class="line">那么答案的格式应该是：(用#号分隔)</div><div class="line">0x80001231#0x80001253#0x80001275#0x80201297#0x802012b9#0x801012db#0x802012ed#0x802012ff#0x80201211</div></pre></td></tr></table></figure>
<p>我们知道iOS内核是基于XNU内核改的，XNU for mac的代码可以从苹果官方下载到：</p>
<ul>
<li>xnu-2782.40.9/bsd/dev/random/randomdev.c</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw random_cdevsw =</div><div class="line">&#123;</div><div class="line">	random_open,		/* open */</div><div class="line">	random_close,		/* close */</div><div class="line">	random_read,		/* read */</div><div class="line">	random_write,		/* write */</div><div class="line">	random_ioctl,		/* ioctl */</div><div class="line">	(stop_fcn_t *)nulldev, /* stop */</div><div class="line">	(reset_fcn_t *)nulldev, /* reset */</div><div class="line">	NULL,				/* tty&apos;s */</div><div class="line">	eno_select,			/* select */</div><div class="line">	eno_mmap,			/* mmap */</div><div class="line">	eno_strat,			/* strategy */</div><div class="line">	eno_getc,			/* getc */</div><div class="line">	eno_putc,			/* putc */</div><div class="line">	0					/* type */</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">/*</div><div class="line"> * Called to initialize our device,</div><div class="line"> * and to register ourselves with devfs</div><div class="line"> */</div><div class="line">void</div><div class="line">random_init(void)</div><div class="line">&#123;</div><div class="line">	int ret;</div><div class="line"></div><div class="line">	ret = cdevsw_add(RANDOM_MAJOR, &amp;random_cdevsw);</div><div class="line">	if (ret &lt; 0) &#123;</div><div class="line">		panic(&quot;random_init: failed to allocate a major number!&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	devfs_make_node(makedev (ret, RANDOM_MINOR), DEVFS_CHAR,</div><div class="line">		UID_ROOT, GID_WHEEL, 0666, &quot;random&quot;, 0);</div><div class="line"></div><div class="line">	/*</div><div class="line">	 * also make urandom </div><div class="line">	 * (which is exactly the same thing in our context)</div><div class="line">	 */</div><div class="line">	devfs_make_node(makedev (ret, URANDOM_MINOR), DEVFS_CHAR,</div><div class="line">		UID_ROOT, GID_WHEEL, 0666, &quot;urandom&quot;, 0);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>将<code>kernercache</code>拖到IDA或者hopper中分析，找到该代码段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">================ B E G I N N I N G   O F   P R O C E D U R E ================</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">             sub_800c0d88:</div><div class="line">800c0d88         push       &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">800c0d8a         add        r7, sp, #0xc</div><div class="line">800c0d8c         sub        sp, #0xc</div><div class="line">800c0d8e         movw       r0, #0xc5c6</div><div class="line">800c0d92         movt       r0, #0x2f</div><div class="line">800c0d96         add        r0, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">800c0d98         addw       r1, r0, #0xb14</div><div class="line">800c0d9c         mov.w      r0, #0xffffffff</div><div class="line">800c0da0         bl         _cdevsw_add</div><div class="line">800c0da4         mov        r4, r0</div><div class="line">800c0da6         cmp.w      r4, #0xffffffff</div><div class="line">800c0daa         bgt        0x800c0dba</div><div class="line"></div><div class="line">800c0dac         movw       r0, #0x655f</div><div class="line">800c0db0         movt       r0, #0x2b</div><div class="line">800c0db4         add        r0, pc                                              ; &quot;\\\\\\\\\\\\\\\\\\\\\\\\&quot;random_init: failed to allocate a major number!\\\\\\\\\\\\\\\\\\\\\\\\&quot;&quot;, argument #1 for method _panic</div><div class="line">800c0db6         bl         _panic</div><div class="line"></div><div class="line">800c0dba         movw       r0, #0x657b                                         ; XREF=sub_800c0d88+34</div><div class="line">800c0dbe         mov.w      r6, #0x1b6</div><div class="line">800c0dc2         movt       r0, #0x2b</div><div class="line">800c0dc6         movs       r5, #0x0</div><div class="line">800c0dc8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node</div><div class="line">800c0dca         add        r0, pc                                              ; &quot;random&quot;</div><div class="line">800c0dcc         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node</div><div class="line">800c0dce         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node</div><div class="line">800c0dd0         lsl.w      r0, r4, #0x18                                       ; argument #1 for method _devfs_make_node</div><div class="line">800c0dd4         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node</div><div class="line">800c0dd6         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node</div><div class="line">800c0dd8         str        r5, [sp, #0x8]</div><div class="line">800c0dda         bl         _devfs_make_node</div><div class="line">800c0dde         movw       r0, #0x6560</div><div class="line">800c0de2         movs       r1, #0x0                                            ; argument #2 for method _devfs_make_node</div><div class="line">800c0de4         movt       r0, #0x2b</div><div class="line">800c0de8         str        r6, [sp]                                            ; argument #5 for method _devfs_make_node</div><div class="line">800c0dea         movs       r2, #0x0                                            ; argument #3 for method _devfs_make_node</div><div class="line">800c0dec         add        r0, pc                                              ; &quot;urandom&quot;</div><div class="line">800c0dee         movs       r3, #0x0                                            ; argument #4 for method _devfs_make_node</div><div class="line">800c0df0         str        r0, [sp, #0x4]                                      ; argument #6 for method _devfs_make_node</div><div class="line">800c0df2         movs       r0, #0x1</div><div class="line">800c0df4         orr.w      r0, r0, r4, lsl #24                                 ; argument #1 for method _devfs_make_node</div><div class="line">800c0df8         str        r5, [sp, #0x8]</div><div class="line">800c0dfa         bl         _devfs_make_node</div><div class="line">800c0dfe         add        sp, #0xc</div><div class="line">800c0e00         pop        &#123;r4, r5, r6, r7, pc&#125;</div><div class="line">                        ; endp</div><div class="line">800c0e02         nop</div></pre></td></tr></table></figure>
<p>从源码中可以看出 <code>cdevsw_add</code> 函数第二个参数为<code>cdevsw</code>结构体地址<br>从汇编中算出<code>random_cdevsw</code>结构体地址为0x803bd360+0xb14 = 0x803BDE74<br>go到0x803BDE74  <code>random_cdevsw</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">803bde74         db  0x19 ; &apos;.&apos;</div><div class="line">803bde75         db  0x0e ; &apos;.&apos;</div><div class="line">803bde76         db  0x0c ; &apos;.&apos;</div><div class="line">803bde77         db  0x80 ; &apos;.&apos;</div><div class="line">803bde78         db  0x35 ; &apos;5&apos;</div><div class="line">803bde79         db  0x0e ; &apos;.&apos;</div><div class="line">803bde7a         db  0x0c ; &apos;.&apos;</div><div class="line">803bde7b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde7c         db  0xa1 ; &apos;.&apos;</div><div class="line">803bde7d         db  0x0e ; &apos;.&apos;</div><div class="line">803bde7e         db  0x0c ; &apos;.&apos;</div><div class="line">803bde7f         db  0x80 ; &apos;.&apos;  ----&gt;random_read 0x800c0ea1</div><div class="line">803bde80         db  0x39 ; &apos;9&apos;</div><div class="line">803bde81         db  0x0e ; &apos;.&apos;</div><div class="line">803bde82         db  0x0c ; &apos;.&apos;</div><div class="line">803bde83         db  0x80 ; &apos;.&apos;  ----&gt;random_write 0x800c0e39</div><div class="line">803bde84         db  0x05 ; &apos;.&apos;</div><div class="line">803bde85         db  0x0e ; &apos;.&apos;</div><div class="line">803bde86         db  0x0c ; &apos;.&apos;</div><div class="line">803bde87         db  0x80 ; &apos;.&apos;  ----&gt;random_ioctl 0x800c0e05</div><div class="line">803bde88         db  0xc9 ; &apos;.&apos;</div><div class="line">803bde89         db  0x73 ; &apos;s&apos;</div><div class="line">803bde8a         db  0x28 ; &apos;(&apos;</div><div class="line">803bde8b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde8c         db  0xc9 ; &apos;.&apos;</div><div class="line">803bde8d         db  0x73 ; &apos;s&apos;</div><div class="line">803bde8e         db  0x28 ; &apos;(&apos;</div><div class="line">803bde8f         db  0x80 ; &apos;.&apos;</div><div class="line">803bde90         db  0x00 ; &apos;.&apos;</div><div class="line">803bde91         db  0x00 ; &apos;.&apos;</div><div class="line">803bde92         db  0x00 ; &apos;.&apos;</div><div class="line">803bde93         db  0x00 ; &apos;.&apos;</div><div class="line">803bde94         db  0xad ; &apos;.&apos;</div><div class="line">803bde95         db  0x73 ; &apos;s&apos;</div><div class="line">803bde96         db  0x28 ; &apos;(&apos;</div><div class="line">803bde97         db  0x80 ; &apos;.&apos;</div><div class="line">803bde98         db  0xad ; &apos;.&apos;</div><div class="line">803bde99         db  0x73 ; &apos;s&apos;</div><div class="line">803bde9a         db  0x28 ; &apos;(&apos;</div><div class="line">803bde9b         db  0x80 ; &apos;.&apos;</div><div class="line">803bde9c         db  0xb1 ; &apos;.&apos;</div><div class="line">803bde9d         db  0x73 ; &apos;s&apos;</div><div class="line">803bde9e         db  0x28 ; &apos;(&apos;</div><div class="line">803bde9f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea0         db  0xad ; &apos;.&apos;</div><div class="line">803bdea1         db  0x73 ; &apos;s&apos;</div><div class="line">803bdea2         db  0x28 ; &apos;(&apos;</div><div class="line">803bdea3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea4         db  0xad ; &apos;.&apos;</div><div class="line">803bdea5         db  0x73 ; &apos;s&apos;</div><div class="line">803bdea6         db  0x28 ; &apos;(&apos;</div><div class="line">803bdea7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdea8         db  0x00 ; &apos;.&apos;</div><div class="line">803bdea9         db  0x00 ; &apos;.&apos;</div><div class="line">803bdeaa         db  0x00 ; &apos;.&apos;</div><div class="line">803bdeab         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/random 结果：  0x800c0ea1#0x800c0e39#0x800c0e05</div></pre></td></tr></table></figure>
<p>(2)设备/dev/pf，对应结构体<code>cdevsw</code>中<code>d_read</code>, <code>d_write</code>, <code>d_ioctl</code>在题目给出<code>kernelcache</code>中的地址。</p>
<ul>
<li>xnu-2782.40.9/bsd/net/pf_ioctl.c:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw pf_cdevsw = &#123;</div><div class="line">	/* open */	pfopen,</div><div class="line">	/* close */	pfclose,</div><div class="line">	/* read */	eno_rdwrt,</div><div class="line">	/* write */	eno_rdwrt,</div><div class="line">	/* ioctl */	pfioctl,</div><div class="line">	/* stop */	eno_stop,</div><div class="line">	/* reset */	eno_reset,</div><div class="line">	/* tty */	NULL,</div><div class="line">	/* select */	eno_select,</div><div class="line">	/* mmap */	eno_mmap,</div><div class="line">	/* strategy */	eno_strat,</div><div class="line">	/* getc */	eno_getc,</div><div class="line">	/* putc */	eno_putc,</div><div class="line">	/* type */	0</div><div class="line">&#125;;</div><div class="line"></div><div class="line">void</div><div class="line">pfinit(void)</div><div class="line">&#123;......</div><div class="line">	maj = cdevsw_add(PF_CDEV_MAJOR, &amp;pf_cdevsw);</div><div class="line">	if (maj == -1) &#123;</div><div class="line">		printf(&quot;%s: failed to allocate major number!\\\\\\\\n&quot;, __func__);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	(void) devfs_make_node(makedev(maj, PFDEV_PF), DEVFS_CHAR,</div><div class="line">	    UID_ROOT, GID_WHEEL, 0600, &quot;pf&quot;, 0);</div><div class="line"></div><div class="line">	(void) devfs_make_node(makedev(maj, PFDEV_PFM), DEVFS_CHAR,</div><div class="line">	    UID_ROOT, GID_WHEEL, 0600, &quot;pfm&quot;, 0);</div><div class="line">......</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对应<code>kernelcache</code>汇编代码（节选）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line">8024b51a         movw       r0, #0x1e3a</div><div class="line">8024b51e         movt       r0, #0x17</div><div class="line">8024b522         add        r0, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">8024b524         addw       r1, r0, #0xbbc</div><div class="line">8024b528         mov.w      r0, #0xffffffff</div><div class="line">8024b52c         bl         _cdevsw_add      </div><div class="line">8024b530         mov        r5, r0</div><div class="line">8024b532         cmp.w      r5, #0xffffffff</div><div class="line">8024b536         beq        0x8024b5ba</div><div class="line"></div><div class="line">8024b538         movw       r0, #0x4532</div><div class="line">8024b53c         mov.w      r4, #0x180</div><div class="line">8024b540         movt       r0, #0x13</div><div class="line">8024b544         mov.w      r11, #0x0</div><div class="line">8024b548         str        r4, [sp]</div><div class="line">8024b54a         add        r0, pc                                              ; &quot;pf&quot;</div><div class="line">8024b54c         movs       r1, #0x0</div><div class="line">8024b54e         str        r0, [sp, #0x4]</div><div class="line">8024b550         lsl.w      r0, r5, #0x18</div><div class="line">8024b554         movs       r2, #0x0</div><div class="line">8024b556         movs       r3, #0x0</div><div class="line">8024b558         str.w      r11, [sp, #0x8]</div><div class="line">8024b55c         bl         _devfs_make_node</div><div class="line">8024b560         movw       r0, #0x4555</div><div class="line">8024b564         movs       r1, #0x0</div><div class="line">8024b566         movt       r0, #0x13</div><div class="line">8024b56a         str        r4, [sp]</div><div class="line">8024b56c         movs       r2, #0x0</div><div class="line">8024b56e         add        r0, pc                                              ; &quot;pfm&quot;</div><div class="line">8024b570         movs       r3, #0x0</div><div class="line">8024b572         str        r0, [sp, #0x4]</div><div class="line">8024b574         movs       r0, #0x1</div><div class="line">8024b576         orr.w      r0, r0, r5, lsl #24</div><div class="line">8024b57a         str.w      r11, [sp, #0x8]</div><div class="line">8024b57e         bl         _devfs_make_node</div><div class="line"></div><div class="line">算出pf_cdevsw结构体地址为0x803bd360+0xbbc = 0x803BDF1C</div><div class="line">go到0x803BDF1C  pf_cdevsw：</div><div class="line">803bdf1c         db  0x65 ; &apos;e&apos;</div><div class="line">803bdf1d         db  0x2c ; &apos;,&apos;</div><div class="line">803bdf1e         db  0x15 ; &apos;.&apos;</div><div class="line">803bdf1f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf20         db  0xf5 ; &apos;.&apos;</div><div class="line">803bdf21         db  0x2b ; &apos;+&apos;</div><div class="line">803bdf22         db  0x15 ; &apos;.&apos;</div><div class="line">803bdf23         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf24         db  0xad ; &apos;.&apos;</div><div class="line">803bdf25         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf26         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf27         db  0x80 ; &apos;.&apos;  ----&gt;eno_rdwrt 0x802873ad</div><div class="line">803bdf28         db  0xad ; &apos;.&apos;</div><div class="line">803bdf29         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf2a         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf2b         db  0x80 ; &apos;.&apos;  ----&gt;eno_rdwrt 0x802873ad</div><div class="line">803bdf2c         db  0x19 ; &apos;.&apos;</div><div class="line">803bdf2d         db  0x9d ; &apos;.&apos;</div><div class="line">803bdf2e         db  0x14 ; &apos;.&apos;</div><div class="line">803bdf2f         db  0x80 ; &apos;.&apos;  ----&gt;pfioctl 0x80149d19</div><div class="line">803bdf30         db  0xad ; &apos;.&apos;</div><div class="line">803bdf31         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf32         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf33         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf34         db  0xad ; &apos;.&apos;</div><div class="line">803bdf35         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf36         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf37         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf38         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf39         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3a         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3b         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf3c         db  0xad ; &apos;.&apos;</div><div class="line">803bdf3d         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf3e         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf3f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf40         db  0xad ; &apos;.&apos;</div><div class="line">803bdf41         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf42         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf43         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf44         db  0xb1 ; &apos;.&apos;</div><div class="line">803bdf45         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf46         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf47         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf48         db  0xad ; &apos;.&apos;</div><div class="line">803bdf49         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf4a         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf4b         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf4c         db  0xad ; &apos;.&apos;</div><div class="line">803bdf4d         db  0x73 ; &apos;s&apos;</div><div class="line">803bdf4e         db  0x28 ; &apos;(&apos;</div><div class="line">803bdf4f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf50         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf51         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf52         db  0x00 ; &apos;.&apos;</div><div class="line">803bdf53         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/pf 的结果：  0x802873ad#0x802873ad#0x80149d19</div></pre></td></tr></table></figure>
<p>(3)设备<code>/dev/ptmx</code>，对应结构体<code>cdevsw</code>中<code>d_read</code>, <code>d_write</code>, <code>d_ioctl</code>在题目给出<code>kernelcache</code>中的地址。</p>
<ul>
<li>/xnu-2782.40.9/bsd/kern/tty_ptmx.c:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">static struct cdevsw ptmx_cdev = &#123;</div><div class="line">	ptcopen,	ptcclose,	ptcread,	ptcwrite,</div><div class="line">	ptyioctl,	ptcstop,	ptcreset,	0,</div><div class="line">	ptcselect,	eno_mmap,	eno_strat,	eno_getc,</div><div class="line">	eno_putc,	D_TTY</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int</div><div class="line">ptmx_init( __unused int config_count)</div><div class="line">&#123;</div><div class="line">	/*</div><div class="line">	 * We start looking at slot 10, since there are inits that will</div><div class="line">	 * stomp explicit slots (e.g. vndevice stomps 1) below that.</div><div class="line">	 */</div><div class="line"></div><div class="line">	/* Get a major number for /dev/ptmx */</div><div class="line">	if((ptmx_major = cdevsw_add(-15, &amp;ptmx_cdev)) == -1) &#123;</div><div class="line">		printf(&quot;ptmx_init: failed to obtain /dev/ptmx major number\\\\\\\\n&quot;);</div><div class="line">		return (ENOENT);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	if (cdevsw_setkqueueok(ptmx_major, &amp;ptmx_cdev, 0) == -1) &#123;</div><div class="line">		panic(&quot;Failed to set flags on ptmx cdevsw entry.&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/* Get a major number for /dev/pts/nnn */</div><div class="line">	if ((ptsd_major = cdevsw_add(-15, &amp;ptsd_cdev)) == -1) &#123;</div><div class="line">		(void)cdevsw_remove(ptmx_major, &amp;ptmx_cdev);</div><div class="line">		printf(&quot;ptmx_init: failed to obtain /dev/ptmx major number\\\\\\\\n&quot;);</div><div class="line">		return (ENOENT);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	if (cdevsw_setkqueueok(ptsd_major, &amp;ptsd_cdev, 0) == -1) &#123;</div><div class="line">		panic(&quot;Failed to set flags on ptmx cdevsw entry.&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/*</div><div class="line">	 * Locks to guard against races between revoke and kevents</div><div class="line">	 */</div><div class="line">	ptsd_kevent_lock_init();</div><div class="line"></div><div class="line">	/* Create the /dev/ptmx device &#123;&lt;major&gt;,0&#125; */</div><div class="line">	(void)devfs_make_node_clone(makedev(ptmx_major, 0),</div><div class="line">				DEVFS_CHAR, UID_ROOT, GID_TTY, 0666,</div><div class="line">				ptmx_clone, PTMX_TEMPLATE);</div><div class="line"></div><div class="line">	_ptmx_driver.master = ptmx_major;</div><div class="line">	_ptmx_driver.slave = ptsd_major;</div><div class="line">	_ptmx_driver.fix_7828447 = 1;</div><div class="line">	_ptmx_driver.fix_7070978 = 1;</div><div class="line">#if CONFIG_MACF</div><div class="line">	_ptmx_driver.mac_notify = 1;</div><div class="line">#endif</div><div class="line">	_ptmx_driver.open = &amp;ptmx_get_ioctl;</div><div class="line">	_ptmx_driver.free = &amp;ptmx_free_ioctl;</div><div class="line">	_ptmx_driver.name = &amp;ptmx_get_name;</div><div class="line">	_ptmx_driver.revoke = &amp;ptsd_revoke_knotes;</div><div class="line">	tty_dev_register(&amp;_ptmx_driver);</div><div class="line"></div><div class="line">	return (0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对应<code>kernelcache</code>汇编代码（节选）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">80293330         push       &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">80293332         add        r7, sp, #0xc</div><div class="line">80293334         push.w     &#123;r8, r10, r11&#125;</div><div class="line">80293338         sub        sp, #0xc</div><div class="line">8029333a         movw       r4, #0xa016</div><div class="line">8029333e         mvn        r0, #0xe</div><div class="line">80293342         movt       r4, #0x12</div><div class="line">80293346         add        r4, pc                                              ; 0x803bd360 (_PE_poll_input + 0xaf4c)</div><div class="line">80293348         addw       r1, r4, #0xc2c</div><div class="line">8029334c         bl         _cdevsw_add</div><div class="line">80293350         movw       r8, #0x6b90</div><div class="line">80293354         cmp.w      r0, #0xffffffff</div><div class="line">80293358         movt       r8, #0x16</div><div class="line">8029335c         add        r8, pc                                              ; 0x803f9ef0</div><div class="line">8029335e         str.w      r0, [r8, #0xc58]                                    ; 0x803fab48</div><div class="line">80293362         beq        0x80293412</div><div class="line"></div><div class="line">80293364         cmp        r0, #0x2a</div><div class="line">80293366         bhi        0x802933a8</div><div class="line"></div><div class="line">80293368         movw       r1, #0xe0d0</div><div class="line">8029336c         rsb        r2, r0, r0, lsl #3</div><div class="line">80293370         movt       r1, #0x11</div><div class="line">80293374         add        r1, pc                                              ; _cdevsw</div><div class="line">80293376         add.w      r1, r1, r2, lsl #3</div><div class="line">8029337a         movs       r2, #0x0</div><div class="line"></div><div class="line">8029337c         adds       r6, r4, r2                                          ; XREF=sub_80293330+92</div><div class="line">8029337e         ldrb       r3, [r1, r2]</div><div class="line">80293380         ldrb.w     r6, [r6, #0xc2c]</div><div class="line">80293384         cmp        r3, r6</div><div class="line">80293386         bne        0x802933a8</div><div class="line"></div><div class="line">80293388         adds       r2, #0x1</div><div class="line">8029338a         cmp        r2, #0x38</div><div class="line">8029338c         bne        0x8029337c</div><div class="line"></div><div class="line">8029338e         movw       r1, #0x583c</div><div class="line">80293392         movs       r2, #0x1</div><div class="line">80293394         movt       r1, #0x16</div><div class="line">80293398         add        r1, pc                                              ; 0x803f8bd8</div><div class="line">8029339a         str.w      r2, [r1, r0, lsl #3]</div><div class="line">8029339e         add.w      r0, r1, r0, lsl #3</div><div class="line">802933a2         movs       r1, #0x0</div><div class="line">802933a4         str        r1, [r0, #0x4]</div><div class="line">802933a6         b          0x802933b6</div><div class="line"></div><div class="line">802933a8         movw       r0, #0xeb91                                         ; XREF=sub_80293330+54, sub_80293330+86</div><div class="line">802933ac         movt       r0, #0xc</div><div class="line">802933b0         add        r0, pc                                              ; &quot;\\\\\\\\\\\\\\\\\\\\\\\\&quot;Failed to set flags on ptmx cdevsw entry.\\\\\\\\\\\\\\\\\\\\\\\\&quot;&quot;, argument #1 for method _panic</div><div class="line">802933b2         bl         _panic</div><div class="line"></div><div class="line">802933b6         addw       r1, r4, #0xc64                                      ; XREF=sub_80293330+118</div><div class="line">802933ba         mvn        r0, #0xe</div><div class="line">802933be         bl         _cdevsw_add</div></pre></td></tr></table></figure>
<p>算出<code>ptmx_cdev</code>结构体地址为0x803bd360+0xc2c = 0x803BDF8C<br>go到0x803BDF8C  <code>ptmx_cdev</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">803bdf8c         db  0x9d ; &apos;.&apos;</div><div class="line">803bdf8d         db  0x1f ; &apos;.&apos;</div><div class="line">803bdf8e         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf8f         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf90         db  0xd5 ; &apos;.&apos;</div><div class="line">803bdf91         db  0x20 ; &apos; &apos;</div><div class="line">803bdf92         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf93         db  0x80 ; &apos;.&apos;</div><div class="line">803bdf94         db  0x51 ; &apos;Q&apos;</div><div class="line">803bdf95         db  0x22 ; &apos;&quot;&apos;</div><div class="line">803bdf96         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf97         db  0x80 ; &apos;.&apos; ----&gt;ptcread 0x80292251</div><div class="line">803bdf98         db  0x61 ; &apos;a&apos;</div><div class="line">803bdf99         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdf9a         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9b         db  0x80 ; &apos;.&apos; ----&gt;ptcwrite 0x80292661</div><div class="line">803bdf9c         db  0x8d ; &apos;.&apos;</div><div class="line">803bdf9d         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9e         db  0x29 ; &apos;)&apos;</div><div class="line">803bdf9f         db  0x80 ; &apos;.&apos; ----&gt;ptyioctl 0x8029298d</div><div class="line">803bdfa0         db  0x59 ; &apos;Y&apos;</div><div class="line">803bdfa1         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdfa2         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfa3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfa4         db  0x5d ; &apos;]&apos;</div><div class="line">803bdfa5         db  0x26 ; &apos;&amp;&apos;</div><div class="line">803bdfa6         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfa7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfa8         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfa9         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfaa         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfab         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfac         db  0x0d ; &apos;.&apos;</div><div class="line">803bdfad         db  0x25 ; &apos;%&apos;</div><div class="line">803bdfae         db  0x29 ; &apos;)&apos;</div><div class="line">803bdfaf         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb0         db  0xad ; &apos;.&apos;</div><div class="line">803bdfb1         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfb2         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfb3         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb4         db  0xb1 ; &apos;.&apos;</div><div class="line">803bdfb5         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfb6         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfb7         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfb8         db  0xad ; &apos;.&apos;</div><div class="line">803bdfb9         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfba         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfbb         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfbc         db  0xad ; &apos;.&apos;</div><div class="line">803bdfbd         db  0x73 ; &apos;s&apos;</div><div class="line">803bdfbe         db  0x28 ; &apos;(&apos;</div><div class="line">803bdfbf         db  0x80 ; &apos;.&apos;</div><div class="line">803bdfc0         db  0x03 ; &apos;.&apos;</div><div class="line">803bdfc1         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfc2         db  0x00 ; &apos;.&apos;</div><div class="line">803bdfc3         db  0x00 ; &apos;.&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">得到 /dev/ptmx 的结果：  0x80292251#0x80292661#0x8029298d</div></pre></td></tr></table></figure>
<p>所以最终结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0x800c0ea1#0x800c0e39#0x800c0e05#0x802873ad#0x802873ad#0x80149d19#0x80292251#0x80292661#0x8029298d</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/09/05/2015第2届移动安全挑战赛iOS第一题分析/" class="prev">PREV</a><a href="/2017/09/05/破解TexturePacker加密资源，寻找解密Key之旅/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'true';
var disqus_identifier = '2017/09/05/2015第2届移动安全挑战赛iOS第二题分析/';
var disqus_title = '2015第2届移动安全挑战赛iOS第二题分析';
var disqus_url = 'http://www.moesoft.com/2017/09/05/2015第2届移动安全挑战赛iOS第二题分析/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//true.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 <a href="http://www.moesoft.com">creantan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>