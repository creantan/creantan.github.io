<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 2015第2届移动安全挑战赛iOS第一题分析 · creantan</title><!--//- var desc = page.desc || page.title + ' - ' + config.author;--><!--//meta(name="description", content=desc)-->            <meta name="description" content="设备iphone6pus 拖到hopper分析，看了下abe列表，看到敏感方法  onCick，静态分析如下:;123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168 -ViewConroer onCick:0000b6a0         push       123;r4, r5, r6, r7, r125;                                ; Objecive C Impemenaion defined a 0x1cd38 insance0000b6a2         add        r7, sp, 0xc0000b6a4         push.w     123;r8, r10, r11125;0000b6a8         sub        sp, 0x200000b6aa         sr        r0, sp, 0x100000b6ac         movw       r0, 0x355c0000b6b0         mov       r0, 0x10000b6b4         movw       r1, 0x354e0000b6b8         mov       r1, 0x10000b6bc         movw       r2, 0x35280000b6c0         mov       r2, 0x10000b6c4         movw       r3, 0x35340000b6c8         add        r0, pc                                              ; @seecordecryp:password:0000b6ca         mov       r3, 0x10000b6ce         movw       r5, 0x352c0000b6d2         add        r1, pc                                              ; @seecororiginaMessage0000b6d4         mov       r5, 0x10000b6d8         movw       r6, 0x10e40000b6dc         dr        r0, r0                                            ; @seecordecryp:password:0000b6de         mov       r6, 0x10000b6e2         sr        r0, sp, 0x1c0000b6e4         add        r3, pc                                              ; @seecorseCodedMessage:0000b6e6         dr        r0, r1                                            ; @seecororiginaMessage0000b6e8         add        r5, pc                                              ; @seecoriniWihCipherKey:0000b6ea         sr        r0, sp, 0x180000b6ec         movw       r0, 0x343a0000b6f0         mov       r0, 0x10000b6f4         add        r2, pc                                              ; @seecordecryp0000b6f6         add        r0, pc                                              ; @seecoraoc0000b6f8         dr.w      r8, r3                                            ; @seecorseCodedMessage:0000b6fc         dr.w      r10, r5                                           ; @seecoriniWihCipherKey:0000b700         add        r6, pc                                              ; @quo;mrMZAbjZozDOGI9UeeH6g0iLHNnTNsFyzS0Yca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTH7hompW+xjTgGg2zQhs0UGQ8Cggev2SNoWcaUOUU==quo;0000b702         dr        r4, r0                                            ; @seecoraoc0000b704         mov.w      r11, 0x50000b708         dr        r1, r2                                            ; @seecordecryp0000b70a         sr        r1, sp, 0x140000b70c         movw       r0, 0x38c2                                         ; XREF=-ViewConroer onCick+2000000b710         mov        r1, r4                                              ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b712         mov       r0, 0x10000b716         add        r0, pc                                              ; objc_cs_ref_Ceasar_CipherMode0000b718         dr        r0, r0                                            ; objc_cs_ref_Ceasar_CipherMode, argumen 1 for mehod imp___symbosub1__objc_msgSend0000b71a         bx        imp___symbosub1__objc_msgSend0000b71e         sub.w      r11, r11, 0x1   ------g;设置ceasar_cipher mode 的cipherKey，循环5次解密4，3，2，1,00000b722         mov        r1, r10                                             ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b724         mov        r2, r110000b726         bx        imp___symbosub1__objc_msgSend0000b72a         mov        r5, r0       0000b72c         mov        r1, r8    ------------g;设置seCodedMessage           ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b72e         mov        r2, r60000b730         bx        imp___symbosub1__objc_msgSend0000b734         dr        r1, sp, 0x14                                     ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b736         mov        r0, r5                                              ; argumen 1 for mehod imp___symbosub1__objc_msgSend0000b738         bx        imp___symbosub1__objc_msgSend0000b73c         dr        r1, sp, 0x18                                     ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b73e         mov        r0, r5                                              ; argumen 1 for mehod imp___symbosub1__objc_msgSend0000b740         bx        imp___symbosub1__objc_msgSend0000b744         mov        r2, r0  ----g;凯撒解密后的字符串用作aes解密0000b746         movw       r0, 0x388c0000b74a         mov       r0, 0x10000b74e         dr        r1, sp, 0x1c                                     ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b750         add        r0, pc                                              ; objc_cs_ref_AESCryp0000b752         dr        r0, r0                                            ; objc_cs_ref_AESCryp, argumen 1 for mehod imp___symbosub1__objc_msgSend0000b754         movw       r3, 0x10980000b758         mov       r3, 0x10000b75c         add        r3, pc            ---g;aes解密秘钥                     ; @quo;ZGhb2RhX2ppYW5rYW5nCg==quo;0000b75e         bx        imp___symbosub1__objc_msgSend  ----g;对凯撒解密后的数据进行aes解密0000b762         mov        r6, r00000b764         cmp.w      r11, 0x0   ------g;循环  5次0000b768         bg        0xb70c0000b76a         movw       r0, 0x346c0000b76e         mov        r10, r40000b770         mov       r0, 0x10000b774         dr.w      r8, sp, 0x100000b778         add        r0, pc                                              ; @seecorexFeid0000b77a         dr        r1, r0                                            ; @seecorexFeid, argumen 2 for mehod imp___symbosub1__objc_msgSend0000b77c         mov        r0, r8                                              ; argumen 1 for mehod imp___symbosub1__objc_msgSend0000b77e         bx        imp___symbosub1__objc_msgSend0000b782         movw       r1, 0x349e0000b786         mov       r1, 0x10000b78a         add        r1, pc                                              ; @seecorex0000b78c         dr        r1, r1                                            ; @seecorex, argumen 2 for mehod imp___symbosub1__objc_msgSend0000b78e         bx        imp___symbosub1__objc_msgSend0000b792         movw       r1, 0x34920000b796         mov       r1, 0x10000b79a         add        r1, pc                                              ; @seecorUTF8Sring0000b79c         dr        r5, r1                                            ; @seecorUTF8Sring0000b79e         mov        r1, r5                                              ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b7a0         bx        imp___symbosub1__objc_msgSend0000b7a4         mov        r4, r00000b7a6         mov        r0, r6                                              ; argumen 1 for mehod imp___symbosub1__objc_msgSend0000b7a8         mov        r1, r5                                              ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b7aa         bx        imp___symbosub1__objc_msgSend0000b7ae         mov        r5, r00000b7b0         drb       r0, r5                                            ; quo;UTF8Sringquo;0000b7b2         cmp        r0, 0x00000b7b4         beq        0xb7d60000b7b6         drb       r1, r40000b7b8         cmp        r1, r00000b7ba         bne        0xb7d20000b7bc         movs       r6, 0x10000b7be         mov        r0, r5                                              ; argumen 1 for mehod imp___symbosub1__sren, XREF=-ViewConroer onCick+3040000b7c0         bx        imp___symbosub1__sren0000b7c4         cmp        r6, r00000b7c6         bhs        0xb7d60000b7c8         drb       r0, r5, r60000b7ca         drb       r1, r4, r60000b7cc         adds       r6, 0x10000b7ce         cmp        r1, r00000b7d0         beq        0xb7be0000b7d2         movs       r4, 0x0                                            ; XREF=-ViewConroer onCick+2820000b7d4         b          0xb7d80000b7d6         movs       r4, 0x1                                            ; XREF=-ViewConroer onCick+276, -ViewConroer onCick+2940000b7d8         movw       r0, 0x37fe                                         ; XREF=-ViewConroer onCick+3080000b7dc         mov        r1, r10                                             ; argumen 2 for mehod imp___symbosub1__objc_msgSend0000b7de         mov       r0, 0x10000b7e2         add        r0, pc                                              ; objc_cs_ref_UIAerView0000b7e4         dr        r0, r0                                            ; objc_cs_ref_UIAerView, argumen 1 for mehod imp___symbosub1__objc_msgSend0000b7e6         bx        imp___symbosub1__objc_msgSend0000b7ea         movw       r1, 0x34380000b7ee         cmp        r4, 0x10000b7f0         mov       r1, 0x10000b7f4         movw       r6, 0x10220000b7f8         add        r1, pc                                              ; @seecoriniWihTie:message:deegae:canceBuonTie:oherBuonTies:0000b7fa         mov       r6, 0x10000b7fe         movw       r2, 0xffa0000b802         add        r6, pc                                              ; cfsring__S_m0000b804         mov       r2, 0x10000b808         dr        r1, r1                                            ; @seecoriniWihTie:message:deegae:canceBuonTie:oherBuonTies:0000b80a         add        r2, pc                                              ; @quo;quo;0000b80c         bne        0xb81a0000b80e         movw       r3, 0xffe0000b812         mov       r3, 0x10000b816         add        r3, pc                                              ; cfsring____xcknx___b_R__eQ__0000b818         b          0xb8240000b81a         movw       r3, 0x1022                                         ; XREF=-ViewConroer onCick+3640000b81e         mov       r3, 0x10000b822         add        r3, pc                                              ; cfsring____x______0000b824         movw       r5, 0x1002                                         ; XREF=-ViewConroer onCick+3760000b828         movs       r4, 0x00000b82a         mov       r5, 0x10000b82e         sr.w      r8, sp0000b832         add        r5, pc                                              ; cfsring_nx__0000b834         sr        r6, sp, 0x40000b836         sr        r5, sp, 0x80000b838         sr        r4, sp, 0xc0000b83a         bx        imp___symbosub1__objc_msgSend0000b83e         movw       r1, 0x33ee0000b842         mov       r1, 0x10000b846         add        r1, pc                                              ; @seecorshow0000b848         dr        r1, r1                                            ; @seecorshow0000b84a         add        sp, 0x200000b84c         pop.w      123;r8, r10, r11125;0000b850         pop.w      123;r4, r5, r6, r7, r125;0000b854         b.w        0x179c0                        ; endp;123456789101112NSSring daa = @quo;mrMZAbjZozDOGI9UeeH6g0iLHNnTNsFyzS0Yca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTH7hompW+xjTgGg2zQhs0UGQ8Cggev2SNoWcaUOUU==quo;;NSSring password = @quo;ZGhb2RhX2ppYW5rYW5nCg==quo;;in imes = 5;do123;    imes--;    Ceasar_CipherMode mode = Ceasar_CipherMode aoc ini;    mode.cipherKey = imes;    mode.codedMessage = daa;    mode decryp;    daa = AESCryp decryp:mode.originaMessage password:password;125;whie imes g; 0;NSLog@quo;resu : @quo;,daa;">
            <meta name="keywords" content="0000,objc,__,___,symbolstub,imp,msgSend,10000,add,selector">        <meta name="theme-color" content="db3333"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.moesoft.com/atom.xml" title="creantan"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/moesoftch" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/creantan" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">2015第2届移动安全挑战赛iOS第一题分析</h1><div class="post-info">Sep 5, 2017</div><div class="post-content"><p>设备iphone6plus 拖到hopper分析，看了下label列表，看到敏感方法  <code>onClick</code>，静态分析如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div></pre></td><td class="code"><pre><div class="line"> -[ViewController onClick]:</div><div class="line">0000b6a0         push       &#123;r4, r5, r6, r7, lr&#125;                                ; Objective C Implementation defined at 0x1cd38 (instance)</div><div class="line">0000b6a2         add        r7, sp, #0xc</div><div class="line">0000b6a4         push.w     &#123;r8, r10, r11&#125;</div><div class="line">0000b6a8         sub        sp, #0x20</div><div class="line">0000b6aa         str        r0, [sp, #0x10]</div><div class="line">0000b6ac         movw       r0, #0x355c</div><div class="line">0000b6b0         movt       r0, #0x1</div><div class="line">0000b6b4         movw       r1, #0x354e</div><div class="line">0000b6b8         movt       r1, #0x1</div><div class="line">0000b6bc         movw       r2, #0x3528</div><div class="line">0000b6c0         movt       r2, #0x1</div><div class="line">0000b6c4         movw       r3, #0x3534</div><div class="line">0000b6c8         add        r0, pc                                              ; @selector(decrypt:password:)</div><div class="line">0000b6ca         movt       r3, #0x1</div><div class="line">0000b6ce         movw       r5, #0x352c</div><div class="line">0000b6d2         add        r1, pc                                              ; @selector(originalMessage)</div><div class="line">0000b6d4         movt       r5, #0x1</div><div class="line">0000b6d8         movw       r6, #0x10e4</div><div class="line">0000b6dc         ldr        r0, [r0]                                            ; @selector(decrypt:password:)</div><div class="line">0000b6de         movt       r6, #0x1</div><div class="line">0000b6e2         str        r0, [sp, #0x1c]</div><div class="line">0000b6e4         add        r3, pc                                              ; @selector(setCodedMessage:)</div><div class="line">0000b6e6         ldr        r0, [r1]                                            ; @selector(originalMessage)</div><div class="line">0000b6e8         add        r5, pc                                              ; @selector(initWithCipherKey:)</div><div class="line">0000b6ea         str        r0, [sp, #0x18]</div><div class="line">0000b6ec         movw       r0, #0x343a</div><div class="line">0000b6f0         movt       r0, #0x1</div><div class="line">0000b6f4         add        r2, pc                                              ; @selector(decrypt)</div><div class="line">0000b6f6         add        r0, pc                                              ; @selector(alloc)</div><div class="line">0000b6f8         ldr.w      r8, [r3]                                            ; @selector(setCodedMessage:)</div><div class="line">0000b6fc         ldr.w      r10, [r5]                                           ; @selector(initWithCipherKey:)</div><div class="line">0000b700         add        r6, pc                                              ; @&quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&quot;</div><div class="line">0000b702         ldr        r4, [r0]                                            ; @selector(alloc)</div><div class="line">0000b704         mov.w      r11, #0x5</div><div class="line">0000b708         ldr        r1, [r2]                                            ; @selector(decrypt)</div><div class="line">0000b70a         str        r1, [sp, #0x14]</div><div class="line"></div><div class="line">0000b70c         movw       r0, #0x38c2                                         ; XREF=-[ViewController onClick]+200</div><div class="line">0000b710         mov        r1, r4                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b712         movt       r0, #0x1</div><div class="line">0000b716         add        r0, pc                                              ; objc_cls_ref_Ceasar_CipherModel</div><div class="line">0000b718         ldr        r0, [r0]                                            ; objc_cls_ref_Ceasar_CipherModel, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b71a         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b71e         sub.w      r11, r11, #0x1   ------&gt;设置ceasar_cipher model 的cipherKey，循环5次解密4，3，2，1,0</div><div class="line">0000b722         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b724         mov        r2, r11</div><div class="line">0000b726         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b72a         mov        r5, r0       </div><div class="line">0000b72c         mov        r1, r8    ------------&gt;设置setCodedMessage           ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b72e         mov        r2, r6</div><div class="line">0000b730         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b734         ldr        r1, [sp, #0x14]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b736         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b738         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b73c         ldr        r1, [sp, #0x18]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b73e         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b740         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b744         mov        r2, r0  ----&gt;凯撒解密后的字符串用作aes解密</div><div class="line">0000b746         movw       r0, #0x388c</div><div class="line">0000b74a         movt       r0, #0x1</div><div class="line">0000b74e         ldr        r1, [sp, #0x1c]                                     ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b750         add        r0, pc                                              ; objc_cls_ref_AESCrypt</div><div class="line">0000b752         ldr        r0, [r0]                                            ; objc_cls_ref_AESCrypt, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b754         movw       r3, #0x1098</div><div class="line">0000b758         movt       r3, #0x1</div><div class="line">0000b75c         add        r3, pc            ---&gt;aes解密秘钥                     ; @&quot;ZGlhb2RhX2ppYW5rYW5nCg==&quot;</div><div class="line">0000b75e         blx        imp___symbolstub1__objc_msgSend  ----&gt;对凯撒解密后的数据进行aes解密</div><div class="line">0000b762         mov        r6, r0</div><div class="line">0000b764         cmp.w      r11, #0x0   ------&gt;循环  5次</div><div class="line">0000b768         bgt        0xb70c</div><div class="line"></div><div class="line">0000b76a         movw       r0, #0x346c</div><div class="line">0000b76e         mov        r10, r4</div><div class="line">0000b770         movt       r0, #0x1</div><div class="line">0000b774         ldr.w      r8, [sp, #0x10]</div><div class="line">0000b778         add        r0, pc                                              ; @selector(textFeild)</div><div class="line">0000b77a         ldr        r1, [r0]                                            ; @selector(textFeild), argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b77c         mov        r0, r8                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b77e         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b782         movw       r1, #0x349e</div><div class="line">0000b786         movt       r1, #0x1</div><div class="line">0000b78a         add        r1, pc                                              ; @selector(text)</div><div class="line">0000b78c         ldr        r1, [r1]                                            ; @selector(text), argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b78e         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b792         movw       r1, #0x3492</div><div class="line">0000b796         movt       r1, #0x1</div><div class="line">0000b79a         add        r1, pc                                              ; @selector(UTF8String)</div><div class="line">0000b79c         ldr        r5, [r1]                                            ; @selector(UTF8String)</div><div class="line">0000b79e         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a0         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a4         mov        r4, r0</div><div class="line">0000b7a6         mov        r0, r6                                              ; argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7a8         mov        r1, r5                                              ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7aa         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7ae         mov        r5, r0</div><div class="line">0000b7b0         ldrb       r0, [r5]                                            ; &quot;UTF8String&quot;</div><div class="line">0000b7b2         cmp        r0, #0x0</div><div class="line">0000b7b4         beq        0xb7d6</div><div class="line"></div><div class="line">0000b7b6         ldrb       r1, [r4]</div><div class="line">0000b7b8         cmp        r1, r0</div><div class="line">0000b7ba         bne        0xb7d2</div><div class="line"></div><div class="line">0000b7bc         movs       r6, #0x1</div><div class="line"></div><div class="line">0000b7be         mov        r0, r5                                              ; argument #1 for method imp___symbolstub1__strlen, XREF=-[ViewController onClick]+304</div><div class="line">0000b7c0         blx        imp___symbolstub1__strlen</div><div class="line">0000b7c4         cmp        r6, r0</div><div class="line">0000b7c6         bhs        0xb7d6</div><div class="line"></div><div class="line">0000b7c8         ldrb       r0, [r5, r6]</div><div class="line">0000b7ca         ldrb       r1, [r4, r6]</div><div class="line">0000b7cc         adds       r6, #0x1</div><div class="line">0000b7ce         cmp        r1, r0</div><div class="line">0000b7d0         beq        0xb7be</div><div class="line"></div><div class="line">0000b7d2         movs       r4, #0x0                                            ; XREF=-[ViewController onClick]+282</div><div class="line">0000b7d4         b          0xb7d8</div><div class="line"></div><div class="line">0000b7d6         movs       r4, #0x1                                            ; XREF=-[ViewController onClick]+276, -[ViewController onClick]+294</div><div class="line"></div><div class="line">0000b7d8         movw       r0, #0x37fe                                         ; XREF=-[ViewController onClick]+308</div><div class="line">0000b7dc         mov        r1, r10                                             ; argument #2 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7de         movt       r0, #0x1</div><div class="line">0000b7e2         add        r0, pc                                              ; objc_cls_ref_UIAlertView</div><div class="line">0000b7e4         ldr        r0, [r0]                                            ; objc_cls_ref_UIAlertView, argument #1 for method imp___symbolstub1__objc_msgSend</div><div class="line">0000b7e6         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b7ea         movw       r1, #0x3438</div><div class="line">0000b7ee         cmp        r4, #0x1</div><div class="line">0000b7f0         movt       r1, #0x1</div><div class="line">0000b7f4         movw       r6, #0x1022</div><div class="line">0000b7f8         add        r1, pc                                              ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)</div><div class="line">0000b7fa         movt       r6, #0x1</div><div class="line">0000b7fe         movw       r2, #0xffa</div><div class="line">0000b802         add        r6, pc                                              ; cfstring__S_m</div><div class="line">0000b804         movt       r2, #0x1</div><div class="line">0000b808         ldr        r1, [r1]                                            ; @selector(initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:)</div><div class="line">0000b80a         add        r2, pc                                              ; @&quot;&quot;</div><div class="line">0000b80c         bne        0xb81a</div><div class="line"></div><div class="line">0000b80e         movw       r3, #0xffe</div><div class="line">0000b812         movt       r3, #0x1</div><div class="line">0000b816         add        r3, pc                                              ; cfstring____xcknx___b_R__eQ__</div><div class="line">0000b818         b          0xb824</div><div class="line"></div><div class="line">0000b81a         movw       r3, #0x1022                                         ; XREF=-[ViewController onClick]+364</div><div class="line">0000b81e         movt       r3, #0x1</div><div class="line">0000b822         add        r3, pc                                              ; cfstring____x______</div><div class="line"></div><div class="line">0000b824         movw       r5, #0x1002                                         ; XREF=-[ViewController onClick]+376</div><div class="line">0000b828         movs       r4, #0x0</div><div class="line">0000b82a         movt       r5, #0x1</div><div class="line">0000b82e         str.w      r8, [sp]</div><div class="line">0000b832         add        r5, pc                                              ; cfstring_nx__</div><div class="line">0000b834         str        r6, [sp, #0x4]</div><div class="line">0000b836         str        r5, [sp, #0x8]</div><div class="line">0000b838         str        r4, [sp, #0xc]</div><div class="line">0000b83a         blx        imp___symbolstub1__objc_msgSend</div><div class="line">0000b83e         movw       r1, #0x33ee</div><div class="line">0000b842         movt       r1, #0x1</div><div class="line">0000b846         add        r1, pc                                              ; @selector(show)</div><div class="line">0000b848         ldr        r1, [r1]                                            ; @selector(show)</div><div class="line">0000b84a         add        sp, #0x20</div><div class="line">0000b84c         pop.w      &#123;r8, r10, r11&#125;</div><div class="line">0000b850         pop.w      &#123;r4, r5, r6, r7, lr&#125;</div><div class="line">0000b854         b.w        0x179c0</div><div class="line">                        ; endp</div></pre></td></tr></table></figure>
<p>用到加密方式：<code>凯撒加密</code>、<code>AES</code></p>
<p>还原代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">NSString* data = @&quot;mrMZAbjtZozDOGI9UeeH6g0iLHNnTNsFyzS0tYca4R3KkaQ0doxdDVuxZ7HoqYOcxFhgDiEvdGKix95VJNEUP8rdox4cm7GHVkbVcTJPmrTtH7hompW+xjTgGg2zQhs0tUGQ8lCggev2SNoWcaUOUU==&quot;;</div><div class="line">NSString* password = @&quot;ZGlhb2RhX2ppYW5rYW5nCg==&quot;;</div><div class="line">int times = 5;</div><div class="line">do&#123;</div><div class="line">    times--;</div><div class="line">    Ceasar_CipherModel* model = [[Ceasar_CipherModel alloc] init];</div><div class="line">    model.cipherKey = times;</div><div class="line">    model.codedMessage = data;</div><div class="line">    [model decrypt];</div><div class="line">    data = [AESCrypt decrypt:model.originalMessage password:password];</div><div class="line">&#125;while (times &gt; 0);</div><div class="line">NSLog(@&quot;result : %@&quot;,data);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">第一次： hDmx1/d5KNhr1BBYQlRNVsZSEaOdw4MtKTpT3082x/x9lZucw0qEm+UhMaOVuoSLyqD1x0elXGXqM4nFSP3W8khfyg1ynDEwLhLt12m68U8=</div><div class="line">第二次： e1s6fwEoaC3l/4VLi1DA4KKPJdGcGWK3elMxPqOuG7MNa9fcfWu6gpui+m3q1akL</div><div class="line">第三次： 4p2eb81lORtnnduYgcAc3pxfqGh8Fybny9NFnTzYJ6B=</div><div class="line">第四次： QNEcNAUUYKq5mMZJTh3J5w==</div><div class="line">第五次： Sp4rkDr0idKit</div></pre></td></tr></table></figure>
<p>最终结果为：</p>
<blockquote>
<p>Sp4rkDr0idKit</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2017/09/05/2015第2届移动安全挑战赛iOS第二题分析/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 <a href="http://www.moesoft.com">creantan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>